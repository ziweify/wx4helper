# 如何切换到测试平台

## ❌ 当前问题

您收到的错误是：`#云顶28平台投注功能待实现`

这说明您当前使用的是**云顶平台**，而不是测试平台。

---

## ✅ 解决方法：切换到测试平台

### 方法1：在BaiShengVx3Plus中修改配置

#### 步骤1：打开配置管理

1. 启动 `BaiShengVx3Plus.exe`
2. 点击菜单栏的 **"配置"** → **"配置管理"**（或按快捷键）

#### 步骤2：选择测试平台

在配置管理窗口中：

1. 找到 **"投注平台"** 下拉框
2. 当前应该显示 **"云顶"** 或其他平台
3. 点击下拉框，选择 **"测试平台"**

#### 步骤3：设置盘口地址（可选）

- 盘口地址可以设置为 `https://www.baidu.com/`（或任意网址）
- 测试平台不会实际访问这个网址

#### 步骤4：保存配置

1. 点击 **"保存"** 按钮
2. 关闭配置管理窗口

#### 步骤5：重启浏览器客户端

1. 关闭当前的浏览器客户端（`BsBrowserClient.exe`）
2. 从BaiShengVx3Plus主界面重新启动浏览器客户端

---

### 方法2：直接修改配置文件（高级）

如果配置管理界面无法打开，可以直接编辑配置文件：

#### 步骤1：找到配置文件

配置文件通常在以下位置之一：
- `BaiShengVx3Plus/Config/config.json`
- `BaiShengVx3Plus/bin/Debug/config.json`

#### 步骤2：修改配置

打开配置文件，找到 `Platform` 或 `BetPlatform` 字段，修改为：

```json
{
  "Platform": "测试平台",
  "PlatformUrl": "https://www.baidu.com/"
}
```

或者使用英文别名：

```json
{
  "Platform": "Test",
  "PlatformUrl": "https://www.baidu.com/"
}
```

#### 步骤3：重启程序

保存配置文件后，重启 BaiShengVx3Plus 和浏览器客户端。

---

## ✅ 验证是否成功切换

### 检查日志

启动浏览器客户端后，在日志中查看：

#### ✅ 成功切换到测试平台

日志应该显示：

```
🔐 [测试平台] 开始登录: ...
✅ [测试平台] 登录成功！用户: ...
💰 [测试平台] 模拟余额: 10000.00 元
```

所有日志都带 `[测试平台]` 前缀。

#### ❌ 仍在使用云顶平台

如果日志中没有 `[测试平台]` 前缀，或者投注时收到：

```
#云顶28平台投注功能待实现
```

说明还没有成功切换，请重新检查配置。

---

## 🎯 测试投注

成功切换后，投注 `1234大10`：

### ✅ 期望结果

```json
{
  "betRecordId": 19,
  "issueId": 115003576,
  "originalContent": "1234大10",
  "standardContent": "1大10,2大10,3大10,4大10",
  "totalAmount": 40.0,
  "betResult": {
    "Success": true,
    "OrderId": "TEST1737187200_1",
    "Result": "{\"status\":true,\"BettingNumber\":\"TEST1737187200_1\",\"msg\":\"投注成功\",\"balance\":9960.00}",
    "ErrorMessage": null,
    "PostStartTime": "2026-01-18 17:30:00.000",
    "PostEndTime": "2026-01-18 17:30:00.300",
    "DurationMs": 300,
    "OrderNo": "TEST1737187200_1",
    "Data": null
  }
}
```

### 关键字段

- `betResult.Success`: **true**（而不是 false）
- `betResult.OrderId`: **TEST开头的订单号**（而不是 null）
- `betResult.Result`: **包含 status:true 的JSON**（而不是错误消息）

---

## 📋 通宝格式对照

测试平台返回的格式与通宝完全一致：

### 通宝响应格式

```json
{
  "status": true,
  "BettingNumber": "TB1737187200123",
  "msg": "投注成功",
  "balance": 9960.00
}
```

### 测试平台响应格式

```json
{
  "status": true,
  "BettingNumber": "TEST1737187200_1",
  "msg": "投注成功",
  "balance": 9960.00
}
```

**完全一致！**唯一区别是订单号前缀（`TB` vs `TEST`）。

---

## 🔍 常见问题

### Q1: 下拉框中没有"测试平台"选项

**原因**: BaiShengVx3Plus.Shared 没有更新

**解决**:
1. 重新编译 `BaiShengVx3Plus.Shared` 项目
2. 确保 `BaiShengVx3Plus.Shared.dll` 已更新
3. 重启 BaiShengVx3Plus

### Q2: 选择了"测试平台"，但还是用云顶

**原因**: 浏览器客户端没有重启

**解决**:
1. 完全关闭浏览器客户端
2. 从 BaiShengVx3Plus 重新启动

### Q3: 配置保存后又恢复了

**原因**: 配置文件权限问题或路径错误

**解决**:
1. 以管理员身份运行 BaiShengVx3Plus
2. 检查配置文件是否只读
3. 手动编辑配置文件（方法2）

---

## 📞 需要帮助？

如果按照上述步骤仍然无法切换到测试平台，请提供以下信息：

1. BaiShengVx3Plus 主界面的日志（包含平台选择信息）
2. 浏览器客户端的日志（前50行）
3. 配置文件内容（Platform 相关部分）

---

## ✅ 切换成功标志

当您看到以下日志时，说明已成功切换：

```
🔐 [测试平台] 开始登录: test
✅ [测试平台] 登录成功！用户: test
💰 [测试平台] 模拟余额: 10000.00 元
🎲 [测试平台] 开始投注: 期号115003576 共4项 40元
   - P1 大: 10元
   - P2 大: 10元
   - P3 大: 10元
   - P4 大: 10元
✅ [测试平台] 投注成功: TEST1737187200_1
💰 [测试平台] 剩余余额: 9960.00 元
```

**所有操作都有 `[测试平台]` 前缀！**

---

**祝测试顺利！** 🎉
