# 测试平台配置检查清单

## ❌ 当前问题

```
错误消息: #云顶28平台投注功能待实现
原因: 当前使用的是云顶平台，而不是测试平台
```

---

## ✅ 解决步骤（快速版）

### 步骤1：打开配置管理

1. 启动 `BaiShengVx3Plus.exe`
2. 找到**投注平台**下拉框（通常在主界面右侧）
3. 确认当前显示的是什么平台

### 步骤2：切换到测试平台

1. 点击下拉框
2. 选择 **"测试平台"**
3. 点击"保存配置"按钮

### 步骤3：重启浏览器

1. 关闭当前浏览器客户端窗口
2. 在 BaiShengVx3Plus 中点击"启动浏览器"按钮

### 步骤4：登录

1. 输入任意用户名（例如：`test`）
2. 输入任意密码（例如：`123456`）
3. 点击登录

### 步骤5：验证

在浏览器客户端日志中查看，应该显示：

```
🔐 [测试平台] 开始登录: test
✅ [测试平台] 登录成功！用户: test
💰 [测试平台] 模拟余额: 10000.00 元
```

---

## 🔍 如何确认当前使用的平台？

### 方法1：查看BaiShengVx3Plus主界面

在主界面右侧，找到"投注平台"下拉框，查看当前选中的值：
- ❌ 如果是"云顶" → 错误，需要切换
- ✅ 如果是"测试平台" → 正确

### 方法2：查看浏览器客户端日志

启动浏览器客户端后，查看日志的前几行：

#### ❌ 使用云顶平台

```
初始化平台脚本: 云顶
创建平台脚本: YunDing28Script
```

#### ✅ 使用测试平台

```
初始化平台脚本: 测试平台
创建平台脚本: TestPlatformScript
🔐 [测试平台] 开始登录: ...
```

### 方法3：测试投注

发送投注命令 `1大10`：

#### ❌ 使用云顶平台

```json
{
  "betResult": {
    "Success": false,
    "ErrorMessage": "#云顶28平台投注功能待实现"
  }
}
```

#### ✅ 使用测试平台

```json
{
  "betResult": {
    "Success": true,
    "OrderId": "TEST1737187200_1",
    "Result": "{\"status\":true,\"BettingNumber\":\"TEST1737187200_1\",\"msg\":\"投注成功\",\"balance\":9990.00}"
  }
}
```

---

## 🎯 期望的投注结果（测试平台）

投注 `1234大10` 后，应该返回：

```json
{
  "betRecordId": 19,
  "issueId": 115003576,
  "originalContent": "1234大10",
  "standardContent": "1大10,2大10,3大10,4大10",
  "totalAmount": 40.0,
  "betResult": {
    "Success": true,
    "OrderId": "TEST1737187455_1",
    "Result": "{\"status\":true,\"BettingNumber\":\"TEST1737187455_1\",\"msg\":\"投注成功\",\"balance\":9960.00}",
    "ErrorMessage": null,
    "PostStartTime": "2026-01-18 17:30:00.000",
    "PostEndTime": "2026-01-18 17:30:00.300",
    "DurationMs": 300,
    "OrderNo": "TEST1737187455_1",
    "Data": null
  }
}
```

### 关键字段对照

| 字段 | 云顶（错误） | 测试平台（正确） |
|------|-------------|----------------|
| `Success` | `false` ❌ | `true` ✅ |
| `OrderId` | `null` ❌ | `TEST开头` ✅ |
| `ErrorMessage` | `#云顶28...` ❌ | `null` ✅ |
| `Result` | 错误消息 ❌ | JSON字符串 ✅ |

---

## 📋 通宝格式对照

测试平台返回的 JSON 格式与通宝完全一致：

```json
{
  "status": true,
  "BettingNumber": "TEST1737187455_1",
  "msg": "投注成功",
  "balance": 9960.00
}
```

**字段说明**：
- `status`: 布尔值，`true` 表示成功
- `BettingNumber`: 订单号，测试平台使用 `TEST{时间戳}_{计数}` 格式
- `msg`: 消息，成功时为"投注成功"
- `balance`: 当前余额（测试平台会自动扣除）

---

## 🚨 常见错误

### 错误1：下拉框中没有"测试平台"

**原因**: 未重新编译项目

**解决**:
```cmd
cd E:\gitcode\wx4helper
dotnet build BaiShengVx3Plus/BaiShengVx3Plus.csproj
```

然后重启 BaiShengVx3Plus。

### 错误2：切换后还是显示云顶

**原因**: 浏览器客户端没有重启

**解决**: 完全关闭浏览器客户端，然后重新启动。

### 错误3：配置保存失败

**原因**: 权限问题

**解决**: 以管理员身份运行 BaiShengVx3Plus。

---

## ✅ 验收标准

投注 `1234大10` 后，应该满足：

1. ✅ `betResult.Success` = `true`
2. ✅ `betResult.OrderId` = `TEST{时间戳}_{计数}`
3. ✅ `betResult.ErrorMessage` = `null`
4. ✅ `betResult.Result` 包含 `"status":true`
5. ✅ `betResult.Result` 包含 `"BettingNumber":"TEST..."`
6. ✅ `betResult.Result` 包含 `"msg":"投注成功"`
7. ✅ `betResult.Result` 包含 `"balance":9960.00`

**如果以上全部满足，说明测试平台配置成功！** 🎉

---

## 📞 需要帮助？

如果按照以上步骤仍然无法切换到测试平台，请提供：

1. BaiShengVx3Plus 主界面截图（显示平台下拉框）
2. 浏览器客户端日志（前100行）
3. 投注命令的完整返回结果

---

**祝测试顺利！** ✨
