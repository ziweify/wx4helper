# ä½¿ç”¨è¾…åŠ©æ–¹æ³•æ·»åŠ æ ‡ç­¾é¡µ - å®Œæ•´ç¤ºä¾‹

**ğŸ“… æ—¥æœŸ**: 2025-12-22  
**ğŸ“Œ ä¸»é¢˜**: å¦‚ä½•ä½¿ç”¨ Main.cs ä¸­çš„è¾…åŠ©æ–¹æ³•å¿«é€Ÿæ·»åŠ  Ribbon æ ‡ç­¾é¡µ  

---

## ğŸ¯ å¿«é€Ÿå¼€å§‹

ç”±äºè®¾è®¡å™¨æ— æ³•ä½¿ç”¨ï¼Œæˆ‘å·²ç»åœ¨ `Main.cs` ä¸­åˆ›å»ºäº†ä¸‰ä¸ªè¾…åŠ©æ–¹æ³•ï¼š

1. **`AddRibbonPage()`** - æ·»åŠ æ ‡ç­¾é¡µ
2. **`CreateRibbonGroup()`** - åˆ›å»ºç»„
3. **`CreateRibbonButton()`** - åˆ›å»ºæŒ‰é’®

---

## ğŸ“ å®Œæ•´ç¤ºä¾‹ï¼šæ·»åŠ "å¼€å¥–ç®¡ç†"æ ‡ç­¾é¡µ

### æ­¥éª¤1ï¼šåœ¨ `InitializeAdditionalRibbonPages()` ä¸­æ·»åŠ ä»£ç 

```csharp
private void InitializeAdditionalRibbonPages()
{
    // æ·»åŠ "å¼€å¥–ç®¡ç†"æ ‡ç­¾é¡µ
    AddLotteryManagementPage();
    
    // æ·»åŠ "æ–¹æ¡ˆç®¡ç†"æ ‡ç­¾é¡µ
    // AddPlanManagementPage();
}
```

### æ­¥éª¤2ï¼šåˆ›å»ºæ ‡ç­¾é¡µæ–¹æ³•

```csharp
private void AddLotteryManagementPage()
{
    // 1. åˆ›å»ºæŒ‰é’®
    var btnStart = CreateRibbonButton(
        "barButtonItemLotteryStart",      // æŒ‰é’®åç§°
        "å¼€å§‹å¼€å¥–",                        // æŒ‰é’®æ–‡æœ¬
        (s, e) => {                        // ç‚¹å‡»äº‹ä»¶
            _loggingService.Info("å¼€å¥–ç®¡ç†", "å¼€å§‹å¼€å¥–...");
            // TODO: å®ç°å¼€å§‹å¼€å¥–é€»è¾‘
        }
    );

    var btnStop = CreateRibbonButton(
        "barButtonItemLotteryStop",
        "åœæ­¢å¼€å¥–",
        (s, e) => {
            _loggingService.Info("å¼€å¥–ç®¡ç†", "åœæ­¢å¼€å¥–...");
            // TODO: å®ç°åœæ­¢å¼€å¥–é€»è¾‘
        }
    );

    var btnConfig = CreateRibbonButton(
        "barButtonItemLotteryConfig",
        "å¼€å¥–é…ç½®",
        (s, e) => {
            _loggingService.Info("å¼€å¥–ç®¡ç†", "æ‰“å¼€é…ç½®...");
            // TODO: æ‰“å¼€é…ç½®çª—å£
        }
    );

    // 2. åˆ›å»ºç»„
    var groupActions = CreateRibbonGroup(
        "ribbonPageGroupLotteryActions",   // ç»„åç§°
        "å¼€å¥–æ“ä½œ",                        // ç»„æ–‡æœ¬
        btnStart,                          // æŒ‰é’®åˆ—è¡¨
        btnStop
    );

    var groupSettings = CreateRibbonGroup(
        "ribbonPageGroupLotterySettings",
        "è®¾ç½®",
        btnConfig
    );

    // 3. åˆ›å»ºå¹¶æ·»åŠ æ ‡ç­¾é¡µ
    AddRibbonPage(
        "ribbonPageLottery",               // æ ‡ç­¾é¡µåç§°
        "å¼€å¥–ç®¡ç†",                        // æ ‡ç­¾é¡µæ–‡æœ¬
        groupActions,                      // ç»„åˆ—è¡¨
        groupSettings
    );
}
```

---

## ğŸš€ æ·»åŠ æ›´å¤šæ ‡ç­¾é¡µ

### ç¤ºä¾‹ï¼šæ·»åŠ "æ–¹æ¡ˆç®¡ç†"æ ‡ç­¾é¡µ

```csharp
private void AddPlanManagementPage()
{
    // åˆ›å»ºæŒ‰é’®
    var btnNew = CreateRibbonButton(
        "barButtonItemPlanNew",
        "æ–°å»ºæ–¹æ¡ˆ",
        (s, e) => { _loggingService.Info("æ–¹æ¡ˆç®¡ç†", "æ–°å»ºæ–¹æ¡ˆ..."); }
    );

    var btnEdit = CreateRibbonButton(
        "barButtonItemPlanEdit",
        "ç¼–è¾‘æ–¹æ¡ˆ",
        (s, e) => { _loggingService.Info("æ–¹æ¡ˆç®¡ç†", "ç¼–è¾‘æ–¹æ¡ˆ..."); }
    );

    var btnDelete = CreateRibbonButton(
        "barButtonItemPlanDelete",
        "åˆ é™¤æ–¹æ¡ˆ",
        (s, e) => { _loggingService.Info("æ–¹æ¡ˆç®¡ç†", "åˆ é™¤æ–¹æ¡ˆ..."); }
    );

    // åˆ›å»ºç»„
    var groupPlanActions = CreateRibbonGroup(
        "ribbonPageGroupPlanActions",
        "æ–¹æ¡ˆæ“ä½œ",
        btnNew,
        btnEdit,
        btnDelete
    );

    // æ·»åŠ æ ‡ç­¾é¡µ
    AddRibbonPage(
        "ribbonPagePlan",
        "æ–¹æ¡ˆç®¡ç†",
        groupPlanActions
    );
}
```

ç„¶ååœ¨ `InitializeAdditionalRibbonPages()` ä¸­è°ƒç”¨ï¼š

```csharp
private void InitializeAdditionalRibbonPages()
{
    AddLotteryManagementPage();
    AddPlanManagementPage();  // æ·»åŠ è¿™ä¸€è¡Œ
}
```

---

## ğŸ“‹ è¾…åŠ©æ–¹æ³•è¯´æ˜

### `CreateRibbonButton()`

```csharp
CreateRibbonButton(
    string buttonName,      // æŒ‰é’®åç§°ï¼ˆç”¨äº Name å±æ€§ï¼‰
    string buttonText,      // æŒ‰é’®æ˜¾ç¤ºæ–‡æœ¬ï¼ˆç”¨äº Caption å±æ€§ï¼‰
    EventHandler? clickHandler  // ç‚¹å‡»äº‹ä»¶å¤„ç†ï¼ˆå¯é€‰ï¼‰
)
```

**åŠŸèƒ½**ï¼š
- è‡ªåŠ¨åˆ†é…ä¸‹ä¸€ä¸ªå¯ç”¨çš„ ItemId
- è‡ªåŠ¨æ·»åŠ åˆ° `ribbonControl1.Items`
- è‡ªåŠ¨æ›´æ–° `MaxItemId`
- è®¾ç½®é»˜è®¤æ ·å¼ä¸º `Large`

### `CreateRibbonGroup()`

```csharp
CreateRibbonGroup(
    string groupName,       // ç»„åç§°
    string groupText,       // ç»„æ˜¾ç¤ºæ–‡æœ¬
    params BarItem[] items  // æŒ‰é’®åˆ—è¡¨ï¼ˆå¯å˜å‚æ•°ï¼‰
)
```

**åŠŸèƒ½**ï¼š
- åˆ›å»ºç»„å¹¶æ·»åŠ æŒ‰é’®
- è¿”å›åˆ›å»ºå¥½çš„ç»„ï¼Œç”¨äºæ·»åŠ åˆ°æ ‡ç­¾é¡µ

### `AddRibbonPage()`

```csharp
AddRibbonPage(
    string pageName,        // æ ‡ç­¾é¡µåç§°
    string pageText,        // æ ‡ç­¾é¡µæ˜¾ç¤ºæ–‡æœ¬
    params RibbonPageGroup[] groups  // ç»„åˆ—è¡¨ï¼ˆå¯å˜å‚æ•°ï¼‰
)
```

**åŠŸèƒ½**ï¼š
- åˆ›å»ºæ ‡ç­¾é¡µå¹¶æ·»åŠ åˆ° `ribbonControl1.Pages`
- è¿”å›åˆ›å»ºå¥½çš„æ ‡ç­¾é¡µ

---

## âœ… ä¼˜åŠ¿

1. **ç®€å•æ˜“ç”¨**ï¼šåªéœ€3è¡Œä»£ç å°±èƒ½æ·»åŠ ä¸€ä¸ªæ ‡ç­¾é¡µ
2. **è‡ªåŠ¨ç®¡ç†**ï¼šè‡ªåŠ¨å¤„ç† IDã€Items é›†åˆç­‰
3. **ç±»å‹å®‰å…¨**ï¼šç¼–è¯‘æ—¶æ£€æŸ¥ï¼Œå‡å°‘é”™è¯¯
4. **æ˜“äºç»´æŠ¤**ï¼šä»£ç æ¸…æ™°ï¼Œä¾¿äºç†è§£å’Œä¿®æ”¹
5. **ä¸ä¾èµ–è®¾è®¡å™¨**ï¼šå®Œå…¨é€šè¿‡ä»£ç ï¼Œä¸å—è®¾è®¡å™¨é™åˆ¶

---

## ğŸ¯ å¿«é€Ÿæ¨¡æ¿

ä»¥åæ·»åŠ æ–°æ ‡ç­¾é¡µï¼Œåªéœ€è¦ï¼š

1. åœ¨ `InitializeAdditionalRibbonPages()` ä¸­è°ƒç”¨æ–¹æ³•
2. åˆ›å»ºæ–¹æ³•ï¼ˆå¤åˆ¶ä¸Šé¢çš„æ¨¡æ¿ï¼Œä¿®æ”¹åç§°å’ŒæŒ‰é’®ï¼‰
3. å®Œæˆï¼

**å°±è¿™ä¹ˆç®€å•ï¼** ğŸš€

