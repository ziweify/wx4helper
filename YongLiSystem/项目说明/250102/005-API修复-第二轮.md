# API ä¿®å¤è¯´æ˜ - ç¬¬äºŒè½®

## ä¿®å¤çš„é”™è¯¯

### 1. CoreWebView2.ConsoleMessageReceived
**é”™è¯¯**: `CoreWebView2` æœªåŒ…å« `ConsoleMessageReceived` çš„å®šä¹‰

**åŸå› **: WebView2 åœ¨ .NET 8 çš„ WinForms ç‰ˆæœ¬ä¸­å¯èƒ½æ²¡æœ‰ `ConsoleMessageReceived` äº‹ä»¶ï¼Œæˆ–è€…éœ€è¦ä¸åŒçš„æ–¹å¼è®¿é—®æ§åˆ¶å°æ—¥å¿—ã€‚

**ä¿®å¤**: æ”¹ç”¨å¯¼èˆªäº‹ä»¶è®°å½•æ—¥å¿—ï¼š
```csharp
// ä¿®å¤å‰
_webView.CoreWebView2.ConsoleMessageReceived += (s, e) =>
{
    LogMessage($"[{e.Level}] {e.Message}");
};

// ä¿®å¤å
_webView.NavigationStarting += (s, e) =>
{
    LogMessage($"ğŸ”„ å¯¼èˆªåˆ°: {e.Uri}");
};

_webView.NavigationCompleted += (s, e) =>
{
    if (e.IsSuccess)
    {
        LogMessage($"âœ… é¡µé¢åŠ è½½æˆåŠŸ");
    }
    else
    {
        LogMessage($"âŒ é¡µé¢åŠ è½½å¤±è´¥: {e.WebErrorStatus}");
    }
};
```

### 2. ScriptValidationResult.ErrorMessage
**é”™è¯¯**: `ScriptValidationResult` æœªåŒ…å« `ErrorMessage` çš„å®šä¹‰

**åŸå› **: æ ¹æ® `Unit.La.Scripting.IScriptEngine.cs` çš„å®šä¹‰ï¼Œå±æ€§åæ˜¯ `Error` è€Œä¸æ˜¯ `ErrorMessage`ã€‚

**ä¿®å¤**:
```csharp
// ä¿®å¤å‰
LogMessage($"âŒ è„šæœ¬éªŒè¯å¤±è´¥: {result.ErrorMessage}");

// ä¿®å¤å
LogMessage($"âŒ è„šæœ¬éªŒè¯å¤±è´¥: {result.Error}");
```

**ScriptValidationResult çš„å®é™…å®šä¹‰**:
```csharp
public class ScriptValidationResult
{
    public bool IsValid { get; set; }
    public string? Error { get; set; }           // âœ… æ­£ç¡®çš„å±æ€§å
    public int LineNumber { get; set; }
    public int ColumnNumber { get; set; }
}
```

## æ³¨æ„äº‹é¡¹

### å…³äºæ§åˆ¶å°æ—¥å¿—
ç”±äº WebView2 çš„æ§åˆ¶å°æ—¥å¿—äº‹ä»¶åœ¨å½“å‰ç‰ˆæœ¬å¯èƒ½ä¸å¯ç”¨ï¼Œæˆ‘ä»¬æ”¹ç”¨ä»¥ä¸‹æ–¹å¼ï¼š

1. **å¯¼èˆªæ—¥å¿—** - è®°å½•é¡µé¢å¯¼èˆª
2. **åŠ è½½çŠ¶æ€** - è®°å½•é¡µé¢åŠ è½½æˆåŠŸ/å¤±è´¥
3. **è„šæœ¬æ‰§è¡Œ** - è„šæœ¬æ‰§è¡Œç»“æœä¼šæ˜¾ç¤ºåœ¨æ—¥å¿—ä¸­

å¦‚æœéœ€è¦çœŸæ­£çš„æ§åˆ¶å°æ—¥å¿—ï¼Œå¯ä»¥ï¼š
- ä½¿ç”¨ `ExecuteScriptAsync("console.log")` æ‹¦æˆª
- ä½¿ç”¨ DevTools Protocol (CDP)
- å‡çº§åˆ°æ”¯æŒè¯¥äº‹ä»¶çš„ WebView2 ç‰ˆæœ¬

### å…³äºè„šæœ¬éªŒè¯
`ValidateScript()` æ–¹æ³•ä¼šï¼š
- è¿”å›éªŒè¯ç»“æœ
- è‡ªåŠ¨æ ‡è®°é”™è¯¯è¡Œ
- è§¦å‘ç›¸å…³äº‹ä»¶

å®Œæˆï¼âœ…
