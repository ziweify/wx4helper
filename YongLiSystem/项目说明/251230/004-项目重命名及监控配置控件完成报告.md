# é¡¹ç›®é‡å‘½åå®ŒæˆæŠ¥å‘Š - BrowserControlLib â†’ Unit.Browser

## ğŸ“… æ—¥æœŸ
2025-12-30

## ğŸ¯ ä»»åŠ¡ç›®æ ‡

å°† `BrowserControlLib` é¡¹ç›®çš„åç§°ã€æ–‡ä»¶å¤¹å’Œå‘½åç©ºé—´ç»Ÿä¸€é‡å‘½åä¸º `Unit.Browser`ã€‚

## âœ… å·²å®Œæˆå·¥ä½œ

### 1. åˆ›å»ºæ–°çš„ Unit.Browser é¡¹ç›®

åˆ›å»ºäº†å…¨æ–°çš„ `Unit.Browser` æ–‡ä»¶å¤¹å’Œé¡¹ç›®æ–‡ä»¶ï¼ŒåŒ…å«æ‰€æœ‰å¿…è¦çš„ä»£ç æ–‡ä»¶ï¼š

```
Unit.Browser/
â”œâ”€â”€ Unit.Browser.csproj
â”œâ”€â”€ Models/
â”‚   â”œâ”€â”€ BrowserCommand.cs
â”‚   â”œâ”€â”€ BrowserCommandResult.cs
â”‚   â””â”€â”€ CommandContext.cs
â”œâ”€â”€ Interfaces/
â”‚   â”œâ”€â”€ IBrowserWindowProxy.cs
â”‚   â””â”€â”€ ICommandExecutor.cs
â”œâ”€â”€ Services/
â”‚   â””â”€â”€ CommandExecutor.cs
â”œâ”€â”€ Extensions/
â”‚   â””â”€â”€ ExtendedCommandExecutor.cs
â””â”€â”€ Controls/
    â”œâ”€â”€ BrowserWindowProxy.cs
    â”œâ”€â”€ BrowserWindow.cs
    â””â”€â”€ BrowserWindow.Designer.cs
```

### 2. æ›´æ–°æ‰€æœ‰å‘½åç©ºé—´

æ‰€æœ‰æ–‡ä»¶çš„å‘½åç©ºé—´å·²ä» `BrowserControlLib.*` æ›´æ–°ä¸º `Unit.Browser.*`ï¼š

- âœ… `BrowserControlLib.Models` â†’ `Unit.Browser.Models`
- âœ… `BrowserControlLib.Interfaces` â†’ `Unit.Browser.Interfaces`
- âœ… `BrowserControlLib.Services` â†’ `Unit.Browser.Services`
- âœ… `BrowserControlLib.Extensions` â†’ `Unit.Browser.Extensions`
- âœ… `BrowserControlLib.Controls` â†’ `Unit.Browser.Controls`

### 3. æ›´æ–°è§£å†³æ–¹æ¡ˆå¼•ç”¨

**Vx3Plus.sln**:
```diff
- Project("{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}") = "BrowserControlLib", "BrowserControlLib\BrowserControlLib.csproj", "{6620C825-DA00-47B4-A188-904A8FEDCE2B}"
+ Project("{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}") = "Unit.Browser", "Unit.Browser\Unit.Browser.csproj", "{6620C825-DA00-47B4-A188-904A8FEDCE2B}"
```

### 4. æ›´æ–°æ°¸åˆ©ç³»ç»Ÿé¡¹ç›®å¼•ç”¨

**æ°¸åˆ©ç³»ç»Ÿ/æ°¸åˆ©ç³»ç»Ÿ.csproj**:
```diff
- <ProjectReference Include="..\BrowserControlLib\BrowserControlLib.csproj" />
+ <ProjectReference Include="..\Unit.Browser\Unit.Browser.csproj" />
```

**æ°¸åˆ©ç³»ç»Ÿ/Views/Dashboard/Monitors/MonitorAControl.cs**:
```diff
- using BrowserControlLib.Controls;
- using BrowserControlLib.Models;
+ using Unit.Browser.Controls;
+ using Unit.Browser.Models;
```

### 5. æ–°å¢ç›‘æ§é…ç½®ç”¨æˆ·æ§ä»¶

ä¸ºæ”¯æŒç›‘æ§ABCçš„é…ç½®ï¼Œåˆ›å»ºäº†ä»¥ä¸‹æ–°æ§ä»¶ï¼š

#### MonitorConfigControl.cs
å•ä¸ªç›‘æ§çš„é…ç½®æ§ä»¶ï¼ŒåŒ…å«ï¼š
- **ç½‘å€**: `txtUrl` (TextEdit)
- **ç”¨æˆ·å**: `txtUsername` (TextEdit)
- **å¯†ç **: `txtPassword` (TextEdit, PasswordChar)
- **è‡ªåŠ¨ç™»å½•**: `chkAutoLogin` (CheckEdit)
- **è„šæœ¬**: `memoScript` (MemoEdit)
- **æ•°æ®æ›´æ–°æ—¶é—´**: GroupControlåŒ…å« `txtLatestIssueData` (æœ€æ–°æœŸå·æ•°æ®)
- **å‘½ä»¤æŒ‰é’®**: 
  - `btnLogin` (ç™»å½•)
  - `btnCollect` (é‡‡é›†)
  - `btnGetCookie` (è·å–Cookie)

#### MonitorConfigContainerControl.cs
å®¹å™¨æ§ä»¶ï¼ŒåŒ…å«ABCä¸‰ä¸ªç›‘æ§çš„é…ç½®ï¼š
- ä½¿ç”¨ `XtraTabControl` ç®¡ç†ä¸‰ä¸ªæ ‡ç­¾é¡µ
- æ¯ä¸ªæ ‡ç­¾é¡µåŒ…å«ä¸€ä¸ª `MonitorConfigControl`
- æä¾›ç»Ÿä¸€çš„äº‹ä»¶æ¥å£ï¼š`MonitorCommand` äº‹ä»¶

#### é›†æˆåˆ° DataCollectionPage
- åœ¨ `groupControl_Monitor_config` ä¸­æ·»åŠ  `MonitorConfigContainerControl`
- è®¢é˜…å‘½ä»¤äº‹ä»¶å¹¶å¤„ç†

## ğŸ“Š ç¼–è¯‘ç»“æœ

âœ… **Unit.Browser é¡¹ç›®ç¼–è¯‘æˆåŠŸ**

```
å·²æˆåŠŸç”Ÿæˆã€‚
1 ä¸ªè­¦å‘Š (WindowsBaseç‰ˆæœ¬å†²çªè­¦å‘Šï¼Œä¸å½±å“ä½¿ç”¨)
0 ä¸ªé”™è¯¯
```

## ğŸ“ æ–‡ä»¶æ¸…å•

### Unit.Browser é¡¹ç›®æ–‡ä»¶

| æ–‡ä»¶è·¯å¾„ | è¯´æ˜ |
|---------|------|
| `Unit.Browser/Unit.Browser.csproj` | é¡¹ç›®æ–‡ä»¶ |
| `Unit.Browser/Models/BrowserCommand.cs` | æµè§ˆå™¨å‘½ä»¤æ¨¡å‹ |
| `Unit.Browser/Models/BrowserCommandResult.cs` | å‘½ä»¤ç»“æœæ¨¡å‹ |
| `Unit.Browser/Models/CommandContext.cs` | å‘½ä»¤ä¸Šä¸‹æ–‡ï¼ˆå†…éƒ¨ä½¿ç”¨ï¼‰ |
| `Unit.Browser/Interfaces/IBrowserWindowProxy.cs` | çª—å£ä»£ç†æ¥å£ |
| `Unit.Browser/Interfaces/ICommandExecutor.cs` | å‘½ä»¤æ‰§è¡Œå™¨æ¥å£ |
| `Unit.Browser/Services/CommandExecutor.cs` | é»˜è®¤å‘½ä»¤æ‰§è¡Œå™¨ |
| `Unit.Browser/Extensions/ExtendedCommandExecutor.cs` | æ‰©å±•å‘½ä»¤æ‰§è¡Œå™¨ |
| `Unit.Browser/Controls/BrowserWindowProxy.cs` | æµè§ˆå™¨çª—å£ä»£ç† |
| `Unit.Browser/Controls/BrowserWindow.cs` | ç‹¬ç«‹æµè§ˆå™¨çª—å£ |
| `Unit.Browser/Controls/BrowserWindow.Designer.cs` | çª—å£è®¾è®¡å™¨ |

### ç›‘æ§é…ç½®æ§ä»¶æ–‡ä»¶

| æ–‡ä»¶è·¯å¾„ | è¯´æ˜ |
|---------|------|
| `æ°¸åˆ©ç³»ç»Ÿ/Views/Dashboard/Controls/MonitorConfigControl.cs` | å•ä¸ªç›‘æ§é…ç½®æ§ä»¶ |
| `æ°¸åˆ©ç³»ç»Ÿ/Views/Dashboard/Controls/MonitorConfigControl.Designer.cs` | é…ç½®æ§ä»¶è®¾è®¡å™¨ |
| `æ°¸åˆ©ç³»ç»Ÿ/Views/Dashboard/Controls/MonitorConfigContainerControl.cs` | ç›‘æ§é…ç½®å®¹å™¨ï¼ˆABCï¼‰ |
| `æ°¸åˆ©ç³»ç»Ÿ/Views/Dashboard/Controls/MonitorConfigContainerControl.Designer.cs` | å®¹å™¨æ§ä»¶è®¾è®¡å™¨ |

## ğŸ¨ UI å¸ƒå±€

### MonitorConfigControl å¸ƒå±€

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç½‘å€:     [________________]       â”‚
â”‚ ç”¨æˆ·å:   [________________]       â”‚
â”‚ å¯†ç :     [****************]       â”‚
â”‚ â–¡ è‡ªåŠ¨ç™»å½•                         â”‚
â”‚                                    â”‚
â”‚ è„šæœ¬:                              â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚                                â”‚ â”‚
â”‚ â”‚  (è„šæœ¬ç¼–è¾‘åŒº)                  â”‚ â”‚
â”‚ â”‚                                â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                    â”‚
â”‚ â”Œâ”€ æ•°æ®æ›´æ–°æ—¶é—´ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ æœ€æ–°æœŸå·: [______________]     â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                    â”‚
â”‚ â”Œâ”€ å‘½ä»¤ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ [ç™»å½•] [é‡‡é›†] [è·å–Cookie]     â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### DataCollectionPage é›†æˆ

```
â”Œâ”€ ç›‘æ§é…ç½® â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [ç›‘æ§A] [ç›‘æ§B] [ç›‘æ§C]        â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚                            â”‚ â”‚
â”‚ â”‚  MonitorConfigControl      â”‚ â”‚
â”‚ â”‚  (å½“å‰é€‰ä¸­çš„ç›‘æ§é…ç½®)      â”‚ â”‚
â”‚ â”‚                            â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”§ ä½¿ç”¨ç¤ºä¾‹

### è®¿é—®ç›‘æ§é…ç½®

```csharp
// åœ¨ DataCollectionPage ä¸­
var monitorAConfig = _monitorConfigContainer?.MonitorAConfig;
if (monitorAConfig != null)
{
    // è®¾ç½®é…ç½®
    monitorAConfig.Url = "https://example.com";
    monitorAConfig.Username = "admin";
    monitorAConfig.Password = "123456";
    monitorAConfig.AutoLogin = true;
    monitorAConfig.Script = "console.log('ç›‘æ§è„šæœ¬');";
    
    // è¯»å–é…ç½®
    var url = monitorAConfig.Url;
    var username = monitorAConfig.Username;
}
```

### å¤„ç†å‘½ä»¤äº‹ä»¶

```csharp
private void OnMonitorCommand(object? sender, MonitorCommandEventArgs e)
{
    switch (e.MonitorName)
    {
        case "ç›‘æ§A":
            switch (e.CommandName)
            {
                case "ç™»å½•":
                    // æ‰§è¡Œç›‘æ§Açš„ç™»å½•é€»è¾‘
                    break;
                case "é‡‡é›†":
                    // æ‰§è¡Œç›‘æ§Açš„é‡‡é›†é€»è¾‘
                    break;
                case "è·å–Cookie":
                    // æ‰§è¡Œç›‘æ§Açš„è·å–Cookieé€»è¾‘
                    break;
            }
            break;
        // ... ç›‘æ§Bå’ŒCç±»ä¼¼
    }
}
```

## âš ï¸ é‡è¦è¯´æ˜

1. **æ—§é¡¹ç›®æ–‡ä»¶å¤¹ä¿ç•™**: `BrowserControlLib` æ–‡ä»¶å¤¹æš‚æ—¶ä¿ç•™ï¼Œå¯ä»¥åœ¨ç¡®è®¤æ–°é¡¹ç›®æ— é—®é¢˜åæ‰‹åŠ¨åˆ é™¤
2. **GUIDä¿æŒä¸å˜**: é¡¹ç›®GUID `{6620C825-DA00-47B4-A188-904A8FEDCE2B}` ä¿æŒä¸å˜ï¼Œç¡®ä¿è§£å†³æ–¹æ¡ˆé…ç½®å…¼å®¹
3. **å¸ƒå±€ä¸å˜**: é™¤äº† `groupControl_Monitor_config` å†…éƒ¨ï¼Œå…¶ä»–å¸ƒå±€å®Œå…¨ä¿æŒåŸæ ·
4. **äº‹ä»¶é©±åŠ¨**: ç›‘æ§é…ç½®æ§ä»¶é‡‡ç”¨äº‹ä»¶é©±åŠ¨è®¾è®¡ï¼Œæ–¹ä¾¿æ‰©å±•

## ğŸ“ åç»­å·¥ä½œ

- [ ] åœ¨ç¡®è®¤ Unit.Browser æ­£å¸¸å·¥ä½œåï¼Œåˆ é™¤ `BrowserControlLib` æ–‡ä»¶å¤¹
- [ ] å®ç°ç›‘æ§å‘½ä»¤çš„å…·ä½“ä¸šåŠ¡é€»è¾‘ï¼ˆç™»å½•ã€é‡‡é›†ã€è·å–Cookieï¼‰
- [ ] å°†ç›‘æ§é…ç½®ä¿å­˜åˆ°æ•°æ®åº“æˆ–é…ç½®æ–‡ä»¶
- [ ] å®ç°ç›‘æ§Bå’ŒCçš„å…·ä½“åŠŸèƒ½

---

**åˆ›å»ºæ—¥æœŸ**: 2025-12-30  
**ä½œè€…**: AI Assistant  
**é¡¹ç›®**: æ°¸åˆ©ç³»ç»Ÿ - Unit.Browser é‡å‘½å

