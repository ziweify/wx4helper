# Quick Access Toolbar (å¿«é€Ÿè®¿é—®å·¥å…·æ ) è¯¦è§£

**ğŸ“… æ—¥æœŸ**: 2025-12-20  
**ğŸ“Œ ä¸»é¢˜**: DevExpress Ribbon å¿«é€Ÿè®¿é—®å·¥å…·æ å’Œåº”ç”¨æŒ‰é’®èœå•è¯¦è§£  
**ğŸ“„ æ–‡ä»¶ç¼–å·**: 251220-004

---

## ğŸ¯ Quick Access Toolbar (QAT) æ˜¯ä»€ä¹ˆï¼Ÿ

### å®šä¹‰

**Quick Access Toolbar (å¿«é€Ÿè®¿é—®å·¥å…·æ )** æ˜¯ä¸€ä¸ªå¯è‡ªå®šä¹‰çš„å·¥å…·æ ï¼Œç”¨äºæ”¾ç½®æœ€å¸¸ç”¨çš„åŠŸèƒ½æŒ‰é’®ï¼Œè®©ç”¨æˆ·æ— éœ€åˆ‡æ¢æ ‡ç­¾é¡µå°±èƒ½å¿«é€Ÿè®¿é—®ã€‚

### ä½ç½®

QAT å¯ä»¥æ˜¾ç¤ºåœ¨ä¸¤ä¸ªä½ç½®ï¼š

1. **Ribbon ä¸Šæ–¹**ï¼ˆé»˜è®¤ä½ç½®ï¼‰
   ```
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ [ä¿å­˜] [æ’¤é”€] [é‡åš]  â† QAT (ä¸Šæ–¹)      â”‚
   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
   â”‚ [ä¸»é¡µ] [æ•°æ®ç®¡ç†] [æŠ¥è¡¨]  â† Ribbonæ ‡ç­¾  â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   ```

2. **Ribbon ä¸‹æ–¹**
   ```
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ [ä¸»é¡µ] [æ•°æ®ç®¡ç†] [æŠ¥è¡¨]  â† Ribbonæ ‡ç­¾  â”‚
   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
   â”‚ [ä¿å­˜] [æ’¤é”€] [é‡åš]  â† QAT (ä¸‹æ–¹)      â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   ```

---

## ğŸ”½ "Show Quick Access Toolbar below the Ribbon" çš„ä½œç”¨

### èœå•é¡¹è¯´æ˜

è¿™ä¸ªèœå•é¡¹ç”¨äº**åˆ‡æ¢ QAT çš„æ˜¾ç¤ºä½ç½®**ï¼š

- âœ… **é€‰ä¸­** â†’ QAT æ˜¾ç¤ºåœ¨ Ribbon **ä¸‹æ–¹**
- âŒ **æœªé€‰ä¸­** â†’ QAT æ˜¾ç¤ºåœ¨ Ribbon **ä¸Šæ–¹**ï¼ˆé»˜è®¤ï¼‰

### ä½¿ç”¨åœºæ™¯

#### æ˜¾ç¤ºåœ¨ä¸Šæ–¹ï¼ˆé»˜è®¤ï¼‰
- âœ… èŠ‚çœå‚ç›´ç©ºé—´
- âœ… ç¬¦åˆ Office é»˜è®¤ä¹ æƒ¯
- âœ… é€‚åˆå±å¹•è¾ƒå°çš„ç¯å¢ƒ

#### æ˜¾ç¤ºåœ¨ä¸‹æ–¹
- âœ… ä¸ Ribbon æ ‡ç­¾é¡µæ›´æ¥è¿‘
- âœ… è§†è§‰ä¸Šæ›´ç»Ÿä¸€
- âœ… é€‚åˆéœ€è¦æ›´å¤š QAT æŒ‰é’®çš„æƒ…å†µ

---

## âœ… å¯ä»¥è‡ªå®šä¹‰èœå•å—ï¼Ÿ

### ç­”æ¡ˆï¼šå®Œå…¨å¯ä»¥ï¼

DevExpress æä¾›äº†å®Œæ•´çš„è‡ªå®šä¹‰æ”¯æŒï¼š

1. âœ… **è‡ªå®šä¹‰ ApplicationButton èœå•**
2. âœ… **æ·»åŠ å¤šä¸ªèœå•é¡¹**
3. âœ… **æ·»åŠ åˆ†éš”çº¿ã€å­èœå•**
4. âœ… **è®¾ç½®é»˜è®¤é€‰é¡¹**
5. âœ… **è‡ªå®šä¹‰ QAT æŒ‰é’®**

---

## ğŸ“ å®ç°æ­¥éª¤

### æ­¥éª¤1: åˆ›å»º ApplicationMenu

```csharp
// åœ¨ Main.Designer.cs ä¸­å£°æ˜
private DevExpress.XtraBars.Ribbon.ApplicationMenu applicationMenu1;
private DevExpress.XtraBars.BarButtonItem menuItemNew;
private DevExpress.XtraBars.BarButtonItem menuItemOpen;
private DevExpress.XtraBars.BarButtonItem menuItemSave;
private DevExpress.XtraBars.BarButtonItem menuItemSaveAs;
private DevExpress.XtraBars.BarButtonItem menuItemPrint;
private DevExpress.XtraBars.BarButtonItem menuItemOptions;
private DevExpress.XtraBars.BarButtonItem menuItemExit;
private DevExpress.XtraBars.BarCheckItem menuItemShowQATBelow;  // QATä½ç½®é€‰é¡¹
```

### æ­¥éª¤2: åœ¨ InitializeComponent ä¸­åˆ›å»ºèœå•

```csharp
private void InitializeComponent()
{
    // ... ç°æœ‰ä»£ç  ...
    
    // åˆ›å»º ApplicationMenu
    applicationMenu1 = new DevExpress.XtraBars.Ribbon.ApplicationMenu();
    applicationMenu1.Name = "applicationMenu1";
    applicationMenu1.Ribbon = ribbonControl1;
    
    // åˆ›å»ºèœå•é¡¹ - æ–‡ä»¶æ“ä½œ
    menuItemNew = new DevExpress.XtraBars.BarButtonItem();
    menuItemNew.Caption = "æ–°å»º";
    menuItemNew.Id = 20;
    menuItemNew.ItemClick += MenuItemNew_ItemClick;
    
    menuItemOpen = new DevExpress.XtraBars.BarButtonItem();
    menuItemOpen.Caption = "æ‰“å¼€";
    menuItemOpen.Id = 21;
    menuItemOpen.ItemClick += MenuItemOpen_ItemClick;
    
    menuItemSave = new DevExpress.XtraBars.BarButtonItem();
    menuItemSave.Caption = "ä¿å­˜";
    menuItemSave.Id = 22;
    menuItemSave.ItemClick += MenuItemSave_ItemClick;
    
    menuItemSaveAs = new DevExpress.XtraBars.BarButtonItem();
    menuItemSaveAs.Caption = "å¦å­˜ä¸º";
    menuItemSaveAs.Id = 23;
    menuItemSaveAs.ItemClick += MenuItemSaveAs_ItemClick;
    
    // åˆ›å»ºèœå•é¡¹ - æ‰“å°
    menuItemPrint = new DevExpress.XtraBars.BarButtonItem();
    menuItemPrint.Caption = "æ‰“å°";
    menuItemPrint.Id = 24;
    menuItemPrint.ItemClick += MenuItemPrint_ItemClick;
    
    // åˆ›å»ºèœå•é¡¹ - é€‰é¡¹
    menuItemOptions = new DevExpress.XtraBars.BarButtonItem();
    menuItemOptions.Caption = "é€‰é¡¹";
    menuItemOptions.Id = 25;
    menuItemOptions.ItemClick += MenuItemOptions_ItemClick;
    
    // åˆ›å»ºèœå•é¡¹ - QATä½ç½®åˆ‡æ¢
    menuItemShowQATBelow = new DevExpress.XtraBars.BarCheckItem();
    menuItemShowQATBelow.Caption = "åœ¨åŠŸèƒ½åŒºä¸‹æ–¹æ˜¾ç¤ºå¿«é€Ÿè®¿é—®å·¥å…·æ ";
    menuItemShowQATBelow.Id = 26;
    menuItemShowQATBelow.Checked = false;  // é»˜è®¤åœ¨ä¸Šæ–¹
    menuItemShowQATBelow.ItemClick += MenuItemShowQATBelow_ItemClick;
    
    // åˆ›å»ºèœå•é¡¹ - é€€å‡º
    menuItemExit = new DevExpress.XtraBars.BarButtonItem();
    menuItemExit.Caption = "é€€å‡º";
    menuItemExit.Id = 27;
    menuItemExit.ItemClick += MenuItemExit_ItemClick;
    
    // æ·»åŠ èœå•é¡¹åˆ° ApplicationMenu
    applicationMenu1.Items.Add(menuItemNew);
    applicationMenu1.Items.Add(menuItemOpen);
    applicationMenu1.Items.Add(menuItemSave);
    applicationMenu1.Items.Add(menuItemSaveAs);
    applicationMenu1.Items.Add(new DevExpress.XtraBars.BarSeparator());  // åˆ†éš”çº¿
    applicationMenu1.Items.Add(menuItemPrint);
    applicationMenu1.Items.Add(new DevExpress.XtraBars.BarSeparator());  // åˆ†éš”çº¿
    applicationMenu1.Items.Add(menuItemOptions);
    applicationMenu1.Items.Add(menuItemShowQATBelow);  // QATä½ç½®é€‰é¡¹
    applicationMenu1.Items.Add(new DevExpress.XtraBars.BarSeparator());  // åˆ†éš”çº¿
    applicationMenu1.Items.Add(menuItemExit);
    
    // å°† ApplicationMenu ç»‘å®šåˆ° RibbonControl
    ribbonControl1.ApplicationButtonDropDownControl = applicationMenu1;
    
    // å°†æ‰€æœ‰èœå•é¡¹æ·»åŠ åˆ° RibbonControl çš„ Items é›†åˆ
    ribbonControl1.Items.AddRange(new DevExpress.XtraBars.BarItem[] {
        menuItemNew,
        menuItemOpen,
        menuItemSave,
        menuItemSaveAs,
        menuItemPrint,
        menuItemOptions,
        menuItemShowQATBelow,
        menuItemExit
    });
}
```

### æ­¥éª¤3: å®ç°äº‹ä»¶å¤„ç†

```csharp
// åœ¨ Main.cs ä¸­æ·»åŠ äº‹ä»¶å¤„ç†æ–¹æ³•

private void MenuItemNew_ItemClick(object sender, ItemClickEventArgs e)
{
    // å®ç°æ–°å»ºåŠŸèƒ½
    MessageBox.Show("æ‰§è¡Œæ–°å»ºæ“ä½œ");
}

private void MenuItemOpen_ItemClick(object sender, ItemClickEventArgs e)
{
    // å®ç°æ‰“å¼€åŠŸèƒ½
    OpenFileDialog dialog = new OpenFileDialog();
    if (dialog.ShowDialog() == DialogResult.OK)
    {
        // å¤„ç†æ‰“å¼€æ–‡ä»¶
        MessageBox.Show($"æ‰“å¼€æ–‡ä»¶: {dialog.FileName}");
    }
}

private void MenuItemSave_ItemClick(object sender, ItemClickEventArgs e)
{
    // è°ƒç”¨ ViewModel çš„ä¿å­˜å‘½ä»¤
    _viewModel.SaveCommand?.Execute(null);
}

private void MenuItemSaveAs_ItemClick(object sender, ItemClickEventArgs e)
{
    // å®ç°å¦å­˜ä¸ºåŠŸèƒ½
    SaveFileDialog dialog = new SaveFileDialog();
    if (dialog.ShowDialog() == DialogResult.OK)
    {
        // å¤„ç†ä¿å­˜æ–‡ä»¶
        MessageBox.Show($"ä¿å­˜åˆ°: {dialog.FileName}");
    }
}

private void MenuItemPrint_ItemClick(object sender, ItemClickEventArgs e)
{
    // å®ç°æ‰“å°åŠŸèƒ½
    MessageBox.Show("æ‰§è¡Œæ‰“å°æ“ä½œ");
}

private void MenuItemOptions_ItemClick(object sender, ItemClickEventArgs e)
{
    // æ‰“å¼€é€‰é¡¹å¯¹è¯æ¡†
    MessageBox.Show("æ‰“å¼€é€‰é¡¹å¯¹è¯æ¡†");
}

// QATä½ç½®åˆ‡æ¢äº‹ä»¶
private void MenuItemShowQATBelow_ItemClick(object sender, ItemClickEventArgs e)
{
    var checkItem = sender as DevExpress.XtraBars.BarCheckItem;
    if (checkItem != null)
    {
        // åˆ‡æ¢ QAT ä½ç½®
        ribbonControl1.ShowQuickAccessToolbarBelowRibbon = checkItem.Checked;
    }
}

private void MenuItemExit_ItemClick(object sender, ItemClickEventArgs e)
{
    Close();
}
```

---

## ğŸ¯ å¯ä»¥å¢åŠ å¤šä¸ªèœå•å—ï¼Ÿ

### ç­”æ¡ˆï¼šå¯ä»¥ï¼æœ‰å¤šç§æ–¹å¼

#### æ–¹å¼1: æ·»åŠ æ›´å¤šèœå•é¡¹

```csharp
// æ·»åŠ æ›´å¤šèœå•é¡¹
var menuItemRecentFiles = new DevExpress.XtraBars.BarButtonItem();
menuItemRecentFiles.Caption = "æœ€è¿‘ä½¿ç”¨çš„æ–‡ä»¶";
menuItemRecentFiles.Id = 28;

var menuItemAbout = new DevExpress.XtraBars.BarButtonItem();
menuItemAbout.Caption = "å…³äº";
menuItemAbout.Id = 29;

applicationMenu1.Items.Add(menuItemRecentFiles);
applicationMenu1.Items.Add(menuItemAbout);
```

#### æ–¹å¼2: ä½¿ç”¨å­èœå•ï¼ˆPopupMenuï¼‰

```csharp
// åˆ›å»ºå­èœå•
var subMenuTools = new DevExpress.XtraBars.PopupMenu();
subMenuTools.Name = "subMenuTools";

var menuItemTool1 = new DevExpress.XtraBars.BarButtonItem();
menuItemTool1.Caption = "å·¥å…·1";
menuItemTool1.Id = 30;

var menuItemTool2 = new DevExpress.XtraBars.BarButtonItem();
menuItemTool2.Caption = "å·¥å…·2";
menuItemTool2.Id = 31;

subMenuTools.AddItems(new DevExpress.XtraBars.BarItem[] {
    menuItemTool1,
    menuItemTool2
});

// åˆ›å»ºå¸¦å­èœå•çš„èœå•é¡¹
var menuItemTools = new DevExpress.XtraBars.BarButtonItem();
menuItemTools.Caption = "å·¥å…·";
menuItemTools.Id = 32;
menuItemTools.ButtonStyle = DevExpress.XtraBars.BarButtonStyle.DropDown;
menuItemTools.DropDownControl = subMenuTools;

applicationMenu1.Items.Add(menuItemTools);
```

#### æ–¹å¼3: ä½¿ç”¨èœå•åˆ†ç»„

```csharp
// æ·»åŠ åˆ†éš”çº¿æ¥åˆ†ç»„
applicationMenu1.Items.Add(menuItemNew);
applicationMenu1.Items.Add(menuItemOpen);
applicationMenu1.Items.Add(menuItemSave);
applicationMenu1.Items.Add(new DevExpress.XtraBars.BarSeparator());  // ç¬¬ä¸€ç»„ç»“æŸ

applicationMenu1.Items.Add(menuItemPrint);
applicationMenu1.Items.Add(new DevExpress.XtraBars.BarSeparator());  // ç¬¬äºŒç»„ç»“æŸ

applicationMenu1.Items.Add(menuItemOptions);
applicationMenu1.Items.Add(menuItemShowQATBelow);
applicationMenu1.Items.Add(new DevExpress.XtraBars.BarSeparator());  // ç¬¬ä¸‰ç»„ç»“æŸ

applicationMenu1.Items.Add(menuItemExit);
```

---

## âœ… å¯ä»¥é»˜è®¤é€‰æ‹©å—ï¼Ÿ

### ç­”æ¡ˆï¼šå¯ä»¥ï¼æœ‰å¤šç§æ–¹å¼

#### æ–¹å¼1: è®¾ç½® QAT é»˜è®¤ä½ç½®

```csharp
// åœ¨ InitializeComponent ä¸­è®¾ç½®
ribbonControl1.ShowQuickAccessToolbarBelowRibbon = true;  // é»˜è®¤åœ¨ä¸‹æ–¹

// åŒæ—¶æ›´æ–°èœå•é¡¹çš„é€‰ä¸­çŠ¶æ€
menuItemShowQATBelow.Checked = true;
```

#### æ–¹å¼2: ä»é…ç½®æ–‡ä»¶è¯»å–

```csharp
// åœ¨ Main.cs çš„æ„é€ å‡½æ•°æˆ– Load äº‹ä»¶ä¸­
private void LoadQATSettings()
{
    // ä»é…ç½®æ–‡ä»¶æˆ–æ³¨å†Œè¡¨è¯»å–è®¾ç½®
    bool showQATBelow = Properties.Settings.Default.ShowQATBelow;  // å‡è®¾æœ‰è®¾ç½®
    
    ribbonControl1.ShowQuickAccessToolbarBelowRibbon = showQATBelow;
    menuItemShowQATBelow.Checked = showQATBelow;
}

private void SaveQATSettings()
{
    // ä¿å­˜è®¾ç½®
    Properties.Settings.Default.ShowQATBelow = ribbonControl1.ShowQuickAccessToolbarBelowRibbon;
    Properties.Settings.Default.Save();
}
```

#### æ–¹å¼3: åœ¨èœå•é¡¹åˆ‡æ¢æ—¶ä¿å­˜

```csharp
private void MenuItemShowQATBelow_ItemClick(object sender, ItemClickEventArgs e)
{
    var checkItem = sender as DevExpress.XtraBars.BarCheckItem;
    if (checkItem != null)
    {
        ribbonControl1.ShowQuickAccessToolbarBelowRibbon = checkItem.Checked;
        
        // ä¿å­˜è®¾ç½®
        SaveQATSettings();
    }
}
```

---

## ğŸ¨ å®Œæ•´ç¤ºä¾‹ä»£ç 

### Main.Designer.cs å®Œæ•´å®ç°

```csharp
// åœ¨ç±»ä¸­å£°æ˜
private DevExpress.XtraBars.Ribbon.ApplicationMenu applicationMenu1;
private DevExpress.XtraBars.BarButtonItem menuItemNew;
private DevExpress.XtraBars.BarButtonItem menuItemOpen;
private DevExpress.XtraBars.BarButtonItem menuItemSave;
private DevExpress.XtraBars.BarButtonItem menuItemSaveAs;
private DevExpress.XtraBars.BarButtonItem menuItemPrint;
private DevExpress.XtraBars.BarButtonItem menuItemOptions;
private DevExpress.XtraBars.BarCheckItem menuItemShowQATBelow;
private DevExpress.XtraBars.BarButtonItem menuItemExit;

private void InitializeComponent()
{
    // ... ç°æœ‰ä»£ç  ...
    
    // åˆ›å»º ApplicationMenu
    applicationMenu1 = new DevExpress.XtraBars.Ribbon.ApplicationMenu();
    applicationMenu1.Name = "applicationMenu1";
    applicationMenu1.Ribbon = ribbonControl1;
    
    // åˆ›å»ºèœå•é¡¹
    menuItemNew = new DevExpress.XtraBars.BarButtonItem();
    menuItemNew.Caption = "æ–°å»º";
    menuItemNew.Id = 20;
    
    menuItemOpen = new DevExpress.XtraBars.BarButtonItem();
    menuItemOpen.Caption = "æ‰“å¼€";
    menuItemOpen.Id = 21;
    
    menuItemSave = new DevExpress.XtraBars.BarButtonItem();
    menuItemSave.Caption = "ä¿å­˜";
    menuItemSave.Id = 22;
    
    menuItemSaveAs = new DevExpress.XtraBars.BarButtonItem();
    menuItemSaveAs.Caption = "å¦å­˜ä¸º";
    menuItemSaveAs.Id = 23;
    
    menuItemPrint = new DevExpress.XtraBars.BarButtonItem();
    menuItemPrint.Caption = "æ‰“å°";
    menuItemPrint.Id = 24;
    
    menuItemOptions = new DevExpress.XtraBars.BarButtonItem();
    menuItemOptions.Caption = "é€‰é¡¹";
    menuItemOptions.Id = 25;
    
    menuItemShowQATBelow = new DevExpress.XtraBars.BarCheckItem();
    menuItemShowQATBelow.Caption = "åœ¨åŠŸèƒ½åŒºä¸‹æ–¹æ˜¾ç¤ºå¿«é€Ÿè®¿é—®å·¥å…·æ ";
    menuItemShowQATBelow.Id = 26;
    menuItemShowQATBelow.Checked = false;  // é»˜è®¤åœ¨ä¸Šæ–¹
    
    menuItemExit = new DevExpress.XtraBars.BarButtonItem();
    menuItemExit.Caption = "é€€å‡º";
    menuItemExit.Id = 27;
    
    // æ·»åŠ èœå•é¡¹ï¼ˆå¸¦åˆ†éš”çº¿ï¼‰
    applicationMenu1.Items.Add(menuItemNew);
    applicationMenu1.Items.Add(menuItemOpen);
    applicationMenu1.Items.Add(menuItemSave);
    applicationMenu1.Items.Add(menuItemSaveAs);
    applicationMenu1.Items.Add(new DevExpress.XtraBars.BarSeparator());
    applicationMenu1.Items.Add(menuItemPrint);
    applicationMenu1.Items.Add(new DevExpress.XtraBars.BarSeparator());
    applicationMenu1.Items.Add(menuItemOptions);
    applicationMenu1.Items.Add(menuItemShowQATBelow);
    applicationMenu1.Items.Add(new DevExpress.XtraBars.BarSeparator());
    applicationMenu1.Items.Add(menuItemExit);
    
    // ç»‘å®šåˆ° RibbonControl
    ribbonControl1.ApplicationButtonDropDownControl = applicationMenu1;
    
    // æ·»åŠ åˆ° Items é›†åˆ
    ribbonControl1.Items.AddRange(new DevExpress.XtraBars.BarItem[] {
        menuItemNew,
        menuItemOpen,
        menuItemSave,
        menuItemSaveAs,
        menuItemPrint,
        menuItemOptions,
        menuItemShowQATBelow,
        menuItemExit
    });
    
    // è®¾ç½® QAT é»˜è®¤ä½ç½®ï¼ˆå¯é€‰ï¼‰
    ribbonControl1.ShowQuickAccessToolbarBelowRibbon = false;  // é»˜è®¤åœ¨ä¸Šæ–¹
}
```

### Main.cs äº‹ä»¶å¤„ç†

```csharp
// åœ¨ Main.cs çš„æ„é€ å‡½æ•°ä¸­ç»‘å®šäº‹ä»¶
public Main()
{
    InitializeComponent();
    _viewModel = new MainViewModel();
    
    // ç»‘å®š ApplicationMenu äº‹ä»¶
    menuItemNew.ItemClick += MenuItemNew_ItemClick;
    menuItemOpen.ItemClick += MenuItemOpen_ItemClick;
    menuItemSave.ItemClick += MenuItemSave_ItemClick;
    menuItemSaveAs.ItemClick += MenuItemSaveAs_ItemClick;
    menuItemPrint.ItemClick += MenuItemPrint_ItemClick;
    menuItemOptions.ItemClick += MenuItemOptions_ItemClick;
    menuItemShowQATBelow.ItemClick += MenuItemShowQATBelow_ItemClick;
    menuItemExit.ItemClick += MenuItemExit_ItemClick;
    
    InitializeNavigation();
    BindViewModel();
    ApplyModernTheme();
}

// äº‹ä»¶å¤„ç†æ–¹æ³•
private void MenuItemNew_ItemClick(object sender, ItemClickEventArgs e)
{
    MessageBox.Show("æ‰§è¡Œæ–°å»ºæ“ä½œ");
}

private void MenuItemOpen_ItemClick(object sender, ItemClickEventArgs e)
{
    OpenFileDialog dialog = new OpenFileDialog();
    if (dialog.ShowDialog() == DialogResult.OK)
    {
        MessageBox.Show($"æ‰“å¼€æ–‡ä»¶: {dialog.FileName}");
    }
}

private void MenuItemSave_ItemClick(object sender, ItemClickEventArgs e)
{
    _viewModel.SaveCommand?.Execute(null);
}

private void MenuItemSaveAs_ItemClick(object sender, ItemClickEventArgs e)
{
    SaveFileDialog dialog = new SaveFileDialog();
    if (dialog.ShowDialog() == DialogResult.OK)
    {
        MessageBox.Show($"ä¿å­˜åˆ°: {dialog.FileName}");
    }
}

private void MenuItemPrint_ItemClick(object sender, ItemClickEventArgs e)
{
    MessageBox.Show("æ‰§è¡Œæ‰“å°æ“ä½œ");
}

private void MenuItemOptions_ItemClick(object sender, ItemClickEventArgs e)
{
    MessageBox.Show("æ‰“å¼€é€‰é¡¹å¯¹è¯æ¡†");
}

// QATä½ç½®åˆ‡æ¢
private void MenuItemShowQATBelow_ItemClick(object sender, ItemClickEventArgs e)
{
    var checkItem = sender as DevExpress.XtraBars.BarCheckItem;
    if (checkItem != null)
    {
        ribbonControl1.ShowQuickAccessToolbarBelowRibbon = checkItem.Checked;
    }
}

private void MenuItemExit_ItemClick(object sender, ItemClickEventArgs e)
{
    Close();
}
```

---

## ğŸ¯ Quick Access Toolbar è‡ªå®šä¹‰

### æ·»åŠ æŒ‰é’®åˆ° QAT

```csharp
// å°†å¸¸ç”¨æŒ‰é’®æ·»åŠ åˆ° QAT
ribbonControl1.QuickAccessToolbar.ItemLinks.Add(barButtonItemSave);
ribbonControl1.QuickAccessToolbar.ItemLinks.Add(barButtonItemRefresh);
ribbonControl1.QuickAccessToolbar.ItemLinks.Add(barButtonItemExit);
```

### è®¾ç½® QAT é»˜è®¤æŒ‰é’®

```csharp
// åœ¨ InitializeComponent ä¸­
ribbonControl1.QuickAccessToolbar.ItemLinks.Add(barButtonItemSave);
ribbonControl1.QuickAccessToolbar.ItemLinks.Add(barButtonItemRefresh);
```

### å…è®¸ç”¨æˆ·è‡ªå®šä¹‰ QAT

```csharp
// å¯ç”¨ QAT è‡ªå®šä¹‰åŠŸèƒ½
ribbonControl1.QuickAccessToolbar.ShowCustomizeItem = true;
```

---

## ğŸ“Š èœå•ç»“æ„ç¤ºä¾‹

### å®Œæ•´çš„ ApplicationMenu ç»“æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ApplicationButton (åº”ç”¨æŒ‰é’®)        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ“„ æ–°å»º                             â”‚
â”‚ ğŸ“‚ æ‰“å¼€                             â”‚
â”‚ ğŸ’¾ ä¿å­˜                             â”‚
â”‚ ğŸ’¾ å¦å­˜ä¸º                           â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚ ğŸ–¨ï¸ æ‰“å°                             â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚ âš™ï¸ é€‰é¡¹                            â”‚
â”‚ â˜‘ï¸ åœ¨åŠŸèƒ½åŒºä¸‹æ–¹æ˜¾ç¤ºå¿«é€Ÿè®¿é—®å·¥å…·æ     â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚ ğŸšª é€€å‡º                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ’¡ æœ€ä½³å®è·µ

### DO âœ…

1. **å°†æœ€å¸¸ç”¨çš„åŠŸèƒ½æ”¾åœ¨ ApplicationMenu**
   - æ–‡ä»¶æ“ä½œï¼ˆæ–°å»ºã€æ‰“å¼€ã€ä¿å­˜ï¼‰
   - ç³»ç»Ÿè®¾ç½®
   - é€€å‡º

2. **ä½¿ç”¨åˆ†éš”çº¿åˆ†ç»„**
   - ç›¸å…³åŠŸèƒ½æ”¾åœ¨ä¸€ç»„
   - ç”¨åˆ†éš”çº¿åŒºåˆ†ä¸åŒåŠŸèƒ½ç»„

3. **QAT æ”¾ç½®æœ€å¸¸ç”¨æŒ‰é’®**
   - ä¿å­˜ã€æ’¤é”€ã€é‡åšç­‰
   - ä¸è¶…è¿‡ 5-7 ä¸ªæŒ‰é’®

4. **ä¿å­˜ç”¨æˆ·è®¾ç½®**
   - QAT ä½ç½®
   - QAT æŒ‰é’®é€‰æ‹©
   - èœå•é¡¹çŠ¶æ€

### DON'T âŒ

1. **ä¸è¦åœ¨ ApplicationMenu ä¸­æ”¾å¤ªå¤šé¡¹**
   - å»ºè®®ä¸è¶…è¿‡ 10-12 ä¸ªèœå•é¡¹

2. **ä¸è¦å¿½ç•¥ç”¨æˆ·è‡ªå®šä¹‰**
   - å…è®¸ç”¨æˆ·è‡ªå®šä¹‰ QAT
   - ä¿å­˜ç”¨æˆ·çš„ä¸ªæ€§åŒ–è®¾ç½®

---

## ğŸ”§ é«˜çº§åŠŸèƒ½

### 1. åŠ¨æ€èœå•ï¼ˆæ ¹æ®ä¸Šä¸‹æ–‡æ˜¾ç¤º/éšè—ï¼‰

```csharp
// æ ¹æ®ç”¨æˆ·æƒé™æ˜¾ç¤º/éšè—èœå•é¡¹
if (userRole == "Admin")
{
    menuItemOptions.Visible = true;
}
else
{
    menuItemOptions.Visible = false;
}
```

### 2. æœ€è¿‘ä½¿ç”¨çš„æ–‡ä»¶åˆ—è¡¨

```csharp
// æ·»åŠ æœ€è¿‘ä½¿ç”¨çš„æ–‡ä»¶
var recentFiles = new List<string> { "æ–‡ä»¶1.txt", "æ–‡ä»¶2.txt" };

foreach (var file in recentFiles)
{
    var menuItem = new DevExpress.XtraBars.BarButtonItem();
    menuItem.Caption = file;
    menuItem.ItemClick += (s, e) => OpenFile(file);
    applicationMenu1.Items.Add(menuItem);
}
```

### 3. èœå•é¡¹å›¾æ ‡

```csharp
// ä¸ºèœå•é¡¹æ·»åŠ å›¾æ ‡
menuItemNew.ImageOptions.SvgImageSize = new System.Drawing.Size(16, 16);
menuItemNew.ImageOptions.SvgImage = yourSvgImage;
```

---

## ğŸ“ æ€»ç»“

### å…³é”®è¦ç‚¹

1. **Quick Access Toolbar (QAT)**
   - å¿«é€Ÿè®¿é—®å¸¸ç”¨åŠŸèƒ½
   - å¯ä»¥æ˜¾ç¤ºåœ¨ Ribbon ä¸Šæ–¹æˆ–ä¸‹æ–¹
   - å¯ä»¥è‡ªå®šä¹‰æŒ‰é’®

2. **ApplicationButton èœå•**
   - å®Œå…¨å¯è‡ªå®šä¹‰
   - å¯ä»¥æ·»åŠ å¤šä¸ªèœå•é¡¹
   - æ”¯æŒåˆ†éš”çº¿ã€å­èœå•
   - å¯ä»¥è®¾ç½®é»˜è®¤é€‰é¡¹

3. **"Show Quick Access Toolbar below the Ribbon"**
   - åˆ‡æ¢ QAT æ˜¾ç¤ºä½ç½®
   - å¯ä»¥è®¾ç½®é»˜è®¤çŠ¶æ€
   - å¯ä»¥ä¿å­˜ç”¨æˆ·é€‰æ‹©

### å®æ–½å»ºè®®

1. âœ… åˆ›å»º ApplicationMenu
2. âœ… æ·»åŠ å¸¸ç”¨èœå•é¡¹
3. âœ… å®ç° QAT ä½ç½®åˆ‡æ¢
4. âœ… ä¿å­˜ç”¨æˆ·è®¾ç½®
5. âœ… æ·»åŠ å¸¸ç”¨æŒ‰é’®åˆ° QAT

---

**æ–‡ä»¶ç±»å‹**: æŠ€æœ¯æŒ‡å—  
**ç‰ˆæœ¬**: v1.0  
**åˆ›å»ºè€…**: AI Assistant  
**æœ€åæ›´æ–°**: 2025-12-20

