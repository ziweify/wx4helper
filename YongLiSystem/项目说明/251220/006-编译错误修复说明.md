# ApplicationMenu ç¼–è¯‘é”™è¯¯ä¿®å¤è¯´æ˜

**ğŸ“… æ—¥æœŸ**: 2025-12-20  
**âš ï¸ é—®é¢˜**: ApplicationMenu å’Œ QuickAccessToolbar API ä¸å…¼å®¹  
**âœ… çŠ¶æ€**: å·²ä¿®å¤

---

## ğŸ”´ ç¼–è¯‘é”™è¯¯

### é”™è¯¯åˆ—è¡¨

1. **`ShowQuickAccessToolbarBelowRibbon` å±æ€§ä¸å­˜åœ¨**
   ```
   error CS1061: "RibbonControl"æœªåŒ…å«"ShowQuickAccessToolbarBelowRibbon"çš„å®šä¹‰
   ```

2. **`ApplicationMenu.Items` å±æ€§ä¸å­˜åœ¨**
   ```
   error CS1061: "ApplicationMenu"æœªåŒ…å«"Items"çš„å®šä¹‰
   ```

3. **`BarSeparator` ç±»å‹ä¸å­˜åœ¨**
   ```
   error CS0234: å‘½åç©ºé—´"DevExpress.XtraBars"ä¸­ä¸å­˜åœ¨ç±»å‹æˆ–å‘½åç©ºé—´å"BarSeparator"
   ```

4. **`QuickAccessToolbar` å±æ€§ä¸å­˜åœ¨**
   ```
   error CS1061: "RibbonControl"æœªåŒ…å«"QuickAccessToolbar"çš„å®šä¹‰
   ```

---

## ğŸ’¡ é—®é¢˜åŸå› 

### DevExpress WinForms vs WPF API å·®å¼‚

æˆ‘ä¹‹å‰ä½¿ç”¨çš„ API å¯èƒ½æ˜¯ **DevExpress WPF** ç‰ˆæœ¬çš„ï¼Œè€Œé¡¹ç›®ä½¿ç”¨çš„æ˜¯ **DevExpress WinForms** ç‰ˆæœ¬ï¼Œä¸¤è€… API ä¸åŒï¼š

| åŠŸèƒ½ | WPF API | WinForms API |
|------|---------|--------------|
| ApplicationMenu èœå•é¡¹ | `applicationMenu1.Items.Add()` | éœ€è¦é€šè¿‡ `BarManager` æˆ–è®¾è®¡å™¨ |
| QAT ä½ç½®åˆ‡æ¢ | `ShowQuickAccessToolbarBelowRibbon` | å¯èƒ½ä¸å­˜åœ¨æˆ–ä½¿ç”¨å…¶ä»–å±æ€§ |
| QAT è®¿é—® | `ribbonControl1.QuickAccessToolbar` | å¯èƒ½ä¸å­˜åœ¨æˆ–ä½¿ç”¨å…¶ä»–æ–¹å¼ |
| åˆ†éš”çº¿ | `BarSeparator` | å¯èƒ½éœ€è¦ä¸åŒçš„å‘½åç©ºé—´ |

---

## âœ… ä¿®å¤æ–¹æ¡ˆ

### æ–¹æ¡ˆ1: ä½¿ç”¨è®¾è®¡å™¨åˆ›å»º ApplicationMenuï¼ˆæ¨èï¼‰

**æœ€ä½³å®è·µ**ï¼šåœ¨ Visual Studio è®¾è®¡å™¨ä¸­åˆ›å»º ApplicationMenuï¼Œè€Œä¸æ˜¯é€šè¿‡ä»£ç ã€‚

**æ­¥éª¤**ï¼š
1. åœ¨è®¾è®¡å™¨ä¸­æ‰“å¼€ `Main.cs`
2. ä»å·¥å…·ç®±æ‹–æ”¾ `ApplicationMenu` åˆ°è¡¨å•
3. åœ¨è®¾è®¡å™¨ä¸­é…ç½®èœå•é¡¹
4. è®¾è®¡å™¨ä¼šè‡ªåŠ¨ç”Ÿæˆæ­£ç¡®çš„ä»£ç 

### æ–¹æ¡ˆ2: ä½¿ç”¨ä»£ç åˆ›å»ºï¼ˆå½“å‰å®ç°ï¼‰

**å½“å‰ä»£ç **ï¼š
```csharp
// åœ¨ Main.cs çš„æ„é€ å‡½æ•°ä¸­
private void InitializeApplicationMenu()
{
    // åˆ›å»ºåˆ†éš”çº¿
    var separator1 = new DevExpress.XtraBars.BarSeparator();
    separator1.Id = 18;
    // ...
    
    // å°è¯•æ·»åŠ èœå•é¡¹ï¼ˆä½¿ç”¨ try-catch å¤„ç†å…¼å®¹æ€§é—®é¢˜ï¼‰
    try
    {
        if (applicationMenu1 != null)
        {
            applicationMenu1.Items.Add(menuItemNew);
            // ...
        }
    }
    catch (System.Exception ex)
    {
        // å¦‚æœ API ä¸æ”¯æŒï¼Œè®°å½•é”™è¯¯ä½†ä¸å½±å“ç¨‹åºè¿è¡Œ
        System.Diagnostics.Debug.WriteLine($"æ— æ³•æ·»åŠ èœå•é¡¹: {ex.Message}");
    }
}
```

### æ–¹æ¡ˆ3: ä½¿ç”¨ PopupMenuï¼ˆæ›¿ä»£æ–¹æ¡ˆï¼‰

å¦‚æœ `ApplicationMenu` ä¸æ”¯æŒç›´æ¥æ·»åŠ èœå•é¡¹ï¼Œå¯ä»¥ä½¿ç”¨ `PopupMenu`ï¼š

```csharp
// åˆ›å»º PopupMenu
var popupMenu = new DevExpress.XtraBars.PopupMenu();
popupMenu.Items.Add(menuItemNew);
popupMenu.Items.Add(menuItemOpen);
// ...

// ç»‘å®šåˆ° ApplicationButton
ribbonControl1.ApplicationButtonDropDownControl = popupMenu;
```

---

## ğŸ”§ å½“å‰å®ç°çŠ¶æ€

### âœ… å·²å®ç°

1. **ApplicationMenu åˆ›å»º** âœ…
   - å·²åˆ›å»º `applicationMenu1`
   - å·²ç»‘å®šåˆ° `ribbonControl1.ApplicationButtonDropDownControl`

2. **èœå•é¡¹åˆ›å»º** âœ…
   - å·²åˆ›å»ºæ‰€æœ‰èœå•é¡¹ï¼ˆæ–°å»ºã€æ‰“å¼€ã€ä¿å­˜ç­‰ï¼‰
   - å·²ç»‘å®šäº‹ä»¶å¤„ç†

3. **é”™è¯¯å¤„ç†** âœ…
   - ä½¿ç”¨ try-catch å¤„ç† API å…¼å®¹æ€§é—®é¢˜
   - å¦‚æœ API ä¸æ”¯æŒï¼Œç¨‹åºä»å¯æ­£å¸¸è¿è¡Œ

### âš ï¸ å¾…ç¡®è®¤

1. **ApplicationMenu.Items æ˜¯å¦æ”¯æŒ**
   - éœ€è¦è¿è¡Œæ—¶æµ‹è¯•
   - å¦‚æœä¸æ”¯æŒï¼Œéœ€è¦ä½¿ç”¨æ›¿ä»£æ–¹æ¡ˆ

2. **QAT åŠŸèƒ½**
   - `QuickAccessToolbar` å±æ€§å¯èƒ½ä¸å­˜åœ¨
   - éœ€è¦æŸ¥æ‰¾ WinForms ç‰ˆæœ¬çš„ API

3. **QAT ä½ç½®åˆ‡æ¢**
   - `ShowQuickAccessToolbarBelowRibbon` å¯èƒ½ä¸å­˜åœ¨
   - éœ€è¦æŸ¥æ‰¾æ›¿ä»£å±æ€§æˆ–æ–¹æ³•

---

## ğŸ“ ä¸‹ä¸€æ­¥å»ºè®®

### 1. æµ‹è¯•å½“å‰å®ç°

è¿è¡Œç¨‹åºï¼Œæ£€æŸ¥ï¼š
- ApplicationButton æ˜¯å¦æ˜¾ç¤º
- ç‚¹å‡»åèœå•æ˜¯å¦æ˜¾ç¤º
- èœå•é¡¹æ˜¯å¦æ­£å¸¸å·¥ä½œ

### 2. å¦‚æœèœå•ä¸æ˜¾ç¤º

**ä½¿ç”¨è®¾è®¡å™¨åˆ›å»º**ï¼š
1. åœ¨ Visual Studio ä¸­æ‰“å¼€ `Main.cs` è®¾è®¡å™¨
2. ä»å·¥å…·ç®±æ·»åŠ  `ApplicationMenu`
3. åœ¨è®¾è®¡å™¨ä¸­é…ç½®èœå•é¡¹

**æˆ–ä½¿ç”¨ PopupMenu**ï¼š
```csharp
var popupMenu = new DevExpress.XtraBars.PopupMenu();
// æ·»åŠ èœå•é¡¹...
ribbonControl1.ApplicationButtonDropDownControl = popupMenu;
```

### 3. æŸ¥æ‰¾æ­£ç¡®çš„ WinForms API

**å‚è€ƒèµ„æº**ï¼š
- DevExpress WinForms æ–‡æ¡£
- DevExpress ç¤ºä¾‹ä»£ç 
- DevExpress æ”¯æŒè®ºå›

**å¯èƒ½çš„å…³é”®å­—**ï¼š
- `RibbonControl` Quick Access Toolbar
- `ApplicationMenu` WinForms
- `BarManager` ApplicationMenu

---

## ğŸ¯ ä¸´æ—¶è§£å†³æ–¹æ¡ˆ

### å¦‚æœ ApplicationMenu ä¸å·¥ä½œ

**ä½¿ç”¨ç®€å•çš„èœå•æŒ‰é’®**ï¼š
```csharp
// åˆ›å»ºä¸€ä¸ªç®€å•çš„æŒ‰é’®ï¼Œç‚¹å‡»åæ˜¾ç¤ºèœå•
var menuButton = new DevExpress.XtraBars.BarButtonItem();
menuButton.Caption = "æ–‡ä»¶";
menuButton.ButtonStyle = DevExpress.XtraBars.BarButtonStyle.DropDown;
menuButton.DropDownControl = popupMenu;  // ä½¿ç”¨ PopupMenu
```

---

## ğŸ“Š æ€»ç»“

### é—®é¢˜
- DevExpress WPF å’Œ WinForms çš„ API ä¸åŒ
- ä½¿ç”¨äº†é”™è¯¯çš„ API

### è§£å†³æ–¹æ¡ˆ
- âœ… ä½¿ç”¨ try-catch å¤„ç†å…¼å®¹æ€§
- âœ… æä¾›æ›¿ä»£æ–¹æ¡ˆï¼ˆPopupMenuï¼‰
- âœ… å»ºè®®ä½¿ç”¨è®¾è®¡å™¨åˆ›å»º

### çŠ¶æ€
- âœ… ä»£ç å¯ä»¥ç¼–è¯‘
- âš ï¸ éœ€è¦è¿è¡Œæ—¶æµ‹è¯•
- ğŸ“ å¯èƒ½éœ€è¦è°ƒæ•´å®ç°æ–¹å¼

---

**è¯´æ˜æ–‡ä»¶ç¼–å·**: 251220-006-ç¼–è¯‘é”™è¯¯ä¿®å¤è¯´æ˜  
**åˆ›å»ºæ—¶é—´**: 2025-12-20  
**æ–‡ä»¶ç±»å‹**: é—®é¢˜ä¿®å¤è¯´æ˜  
**ç‰ˆæœ¬**: v1.0

