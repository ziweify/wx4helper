# âœ… è®¢å•ç»“ç®—å’Œä¼šå‘˜ç»Ÿè®¡å®Œæ•´å®ç°

## ğŸ¯ ç”¨æˆ·éœ€æ±‚

### é—®é¢˜ 1ï¼šå¼€å¥–åè®¢å•æ²¡æœ‰ç»“ç®—
å¼€å¥–æ•°æ®å·²è·å–ï¼Œä½†è®¢å•çŠ¶æ€ä»ä¸º `å¾…ç»“ç®—`ï¼Œ`Profit` å’Œ `NetProfit` ä¸º 0ã€‚

### é—®é¢˜ 2ï¼šä¼šå‘˜ç»Ÿè®¡æ•°æ®æ²¡æœ‰æ›´æ–°
- `BetWait` (å¾…ç»“ç®—é‡‘é¢) æ²¡æœ‰å¢å‡
- `IncomeToday` (ä»Šæ—¥ç›ˆäº) æ²¡æœ‰æ›´æ–°
- `BetToday` (ä»Šæ—¥ä¸‹æ³¨) æ²¡æœ‰æ›´æ–°
- `Balance` (ä½™é¢) æ²¡æœ‰æ­£ç¡®æ›´æ–°

### é—®é¢˜ 3ï¼šä¸‹æ³¨å›å¤æ ¼å¼ä¸æ­£ç¡®
å½“å‰æ ¼å¼ï¼š
```
âœ… ä¸‹æ³¨æˆåŠŸï¼
æœŸå·: 114062935
å†…å®¹: 1å¤§/2å°
é‡‘é¢: 150.00
ä½™é¢: 850.00
```

**F5BotV2 æ ¼å¼**ï¼ˆç¬¬ 2413 è¡Œï¼‰ï¼š
```
@å¼ ä¸‰
å·²è¿›ä»“2
1å¤§/2å°|æ‰£:150|ç•™:850
```

---

## ğŸ” é—®é¢˜æ ¹å› 

### æ ¹å›  1ï¼šæ²¡æœ‰ç›‘å¬ `LotteryOpened` äº‹ä»¶è§¦å‘ç»“ç®—

æŸ¥çœ‹ F5BotV2 çš„æµç¨‹ï¼ˆ`BoterServices.cs` ç¬¬ 1075 è¡Œï¼‰ï¼š
```csharp
BoterStatusChange?.Invoke(_status, bgData.IssueId, bgData);
Onå·²å¼€å¥–(bgData);  // ğŸ”¥ å¼€å¥–åç«‹å³è§¦å‘ç»“ç®—
```

è€Œ `BaiShengVx3Plus` çš„ `BinggoLotteryService` è™½ç„¶è§¦å‘äº† `LotteryOpened` äº‹ä»¶ï¼Œä½† **æ²¡æœ‰ä»»ä½•æœåŠ¡è®¢é˜…å¹¶å¤„ç†ç»“ç®—**ï¼

---

### æ ¹å›  2ï¼š`BetWait` å­—æ®µé€»è¾‘æœªå®ç°

F5BotV2 çš„ `BetWait` ä¸šåŠ¡é€»è¾‘ï¼ˆ3 ä¸ªå…³é”®ç‚¹ï¼‰ï¼š

1. **ä¸‹æ³¨æ—¶å¢åŠ **ï¼ˆç¬¬ 546 è¡Œï¼‰ï¼š
   ```csharp
   m.BetWait = m.BetWait + order.AmountTotal;
   ```

2. **ç»“ç®—æ—¶æ‰£é™¤**ï¼ˆç¬¬ 633 è¡Œï¼‰ï¼š
   ```csharp
   m.BetWait = m.BetWait - order.AmountTotal;
   ```

3. **å–æ¶ˆè®¢å•æ—¶æ¢å¤**ï¼ˆç¬¬ 685 è¡Œï¼‰ï¼š
   ```csharp
   m.BetWait = m.BetWait - order.AmountTotal;
   ```

**å½“å‰å®ç°**ï¼šä¸‹æ³¨æ—¶æ²¡æœ‰å¢åŠ  `BetWait`ï¼Œç»“ç®—æ—¶ä¹Ÿæ²¡æœ‰æ‰£é™¤ï¼Œå¯¼è‡´ç»Ÿè®¡æ•°æ®ä¸å‡†ç¡®ã€‚

---

### æ ¹å›  3ï¼šç»“ç®—é€»è¾‘ä¸å®Œæ•´

F5BotV2 çš„ `OnMemberOrderFinish` æ–¹æ³•ï¼ˆç¬¬ 582-639 è¡Œï¼‰å®Œæ•´æµç¨‹ï¼š

```csharp
// 1. è°ƒç”¨ order.OpenLottery(data, odds, zsjs) è®¡ç®—ç›ˆåˆ©
float win = order.OpenLottery(data, _appSetting.wxOdds, _appSetting.Zsjs);

// 2. è°ƒç”¨ m.OpenLottery(order) æ›´æ–°ä¼šå‘˜æ•°æ®
m.OpenLottery(order);

// 3. æ‰£é™¤ BetWait
m.BetWait = m.BetWait - order.AmountTotal;

// 4. æ›´æ–°è®¢å•çŠ¶æ€
order.OrderStatus = OrderStatusEnum.å·²å®Œæˆ;
```

**å½“å‰å®ç°**ï¼šåªæ›´æ–°äº† `Balance`ï¼Œæ²¡æœ‰æ›´æ–° `IncomeToday`ã€`IncomeTotal`ã€`BetWait`ã€‚

---

## âœ… ä¿®å¤æ–¹æ¡ˆ

### ä¿®å¤ 1ï¼šä¸‹æ³¨å›å¤æ ¼å¼ï¼ˆå‚è€ƒ F5BotV2 ç¬¬ 2413 è¡Œï¼‰

**æ–‡ä»¶**ï¼š`BaiShengVx3Plus/Services/Games/Binggo/BinggoOrderService.cs`

**æ—§ä»£ç **ï¼ˆç¬¬ 154-158 è¡Œï¼‰ï¼š
```csharp
string replyMessage = $"{_settings.ReplySuccess}\n" +
                    $"æœŸå·: {issueId}\n" +
                    $"å†…å®¹: {betContent.ToReplyString()}\n" +
                    $"é‡‘é¢: {betContent.TotalAmount:F2}\n" +
                    $"ä½™é¢: {member.Balance:F2}";
```

**æ–°ä»£ç **ï¼ˆğŸ”¥ å®Œå…¨å‚è€ƒ F5BotV2ï¼‰ï¼š
```csharp
// æ ¼å¼ï¼š@æ˜µç§°\rå·²è¿›ä»“{æ³¨æ•°}\r{æŠ•æ³¨å†…å®¹}|æ‰£:{é‡‘é¢}|ç•™:{ä½™é¢}
string replyMessage = $"@{member.Nickname}\rå·²è¿›ä»“{order.Nums}\r{betContent.ToReplyString()}|æ‰£:{(int)order.AmountTotal}|ç•™:{(int)member.Balance}";
```

**å…³é”®ç‚¹**ï¼š
- âœ… ä½¿ç”¨ `\r` æ¢è¡Œï¼ˆä¸æ˜¯ `\n`ï¼‰
- âœ… é‡‘é¢å’Œä½™é¢ä½¿ç”¨ `(int)` è½¬æ¢ä¸ºæ•´æ•°
- âœ… æ ¼å¼ç´§å‡‘ï¼Œç”¨ `|` åˆ†éš”

---

### ä¿®å¤ 2ï¼šä¸‹æ³¨æ—¶å¢åŠ  `BetWait`ï¼ˆå‚è€ƒ F5BotV2 ç¬¬ 546 è¡Œï¼‰

**æ–‡ä»¶**ï¼š`BaiShengVx3Plus/Services/Games/Binggo/BinggoOrderService.cs`

**åœ¨ `CreateOrderAsync` æ–¹æ³•ä¸­ï¼Œä¿å­˜è®¢å•åå¢åŠ  `BetWait`ï¼š**

```csharp
// 4. æ‰£é™¤ä½™é¢
if (member.State != MemberState.æ‰˜ && member.State != MemberState.ç®¡ç†)
{
    member.Balance -= (float)betContent.TotalAmount;
    _logService.Info("BinggoOrderService", 
        $"æ‰£é™¤ä½™é¢: {member.Nickname} - {betContent.TotalAmount:F2}ï¼Œå‰©ä½™: {member.Balance:F2}");
}

// ğŸ”¥ æ–°å¢ï¼šå¢åŠ å¾…ç»“ç®—é‡‘é¢ï¼ˆå‚è€ƒ F5BotV2 ç¬¬ 546 è¡Œï¼‰
member.BetWait += (float)betContent.TotalAmount;

// ğŸ”¥ æ–°å¢ï¼šå¢åŠ ä»Šæ—¥ä¸‹æ³¨ï¼ˆå¦‚æœéœ€è¦ï¼‰
member.BetToday += (float)betContent.TotalAmount;
member.BetTotal += (float)betContent.TotalAmount;

// 5. ä¿å­˜è®¢å•ï¼ˆé€šè¿‡ BindingList è‡ªåŠ¨ä¿å­˜ï¼‰
_ordersBindingList?.Add(order);
```

---

### ä¿®å¤ 3ï¼šå®Œæ•´çš„è®¢å•ç»“ç®—é€»è¾‘ï¼ˆå‚è€ƒ F5BotV2 ç¬¬ 622-636 è¡Œï¼‰

**æ–‡ä»¶**ï¼š`BaiShengVx3Plus/Services/Games/Binggo/BinggoOrderService.cs`

**ä¿®æ”¹ `SettleSingleOrderAsync` æ–¹æ³•ï¼š**

```csharp
/// <summary>
/// ç»“ç®—å•ä¸ªè®¢å•ï¼ˆğŸ”¥ å®Œå…¨å‚è€ƒ F5BotV2 çš„ OnMemberOrderFinish é€»è¾‘ï¼‰
/// </summary>
private async Task SettleSingleOrderAsync(V2MemberOrder order, BinggoLotteryData lotteryData)
{
    try
    {
        // ğŸ”¥ å‚è€ƒ F5BotV2: ç¬¬ 599-640 è¡Œ
        
        // 1. æ£€æŸ¥è®¢å•çŠ¶æ€
        if (order.OrderStatus == OrderStatus.å·²å®Œæˆ)
        {
            _logService.Info("BinggoOrderService", $"è®¢å•å·²ç»“ç®—ï¼Œè·³è¿‡: {order.Id}");
            return;
        }
        
        if (order.OrderStatus == OrderStatus.å·²å–æ¶ˆ)
        {
            _logService.Info("BinggoOrderService", $"è®¢å•å·²å–æ¶ˆï¼Œè·³è¿‡: {order.Id}");
            return;
        }
        
        // 2. è§£æä¸‹æ³¨å†…å®¹ï¼ˆä½¿ç”¨ BetContentStandar å­—æ®µï¼‰
        var betContent = BinggoHelper.ParseBetContent(order.BetContentStandar ?? string.Empty, order.IssueId);
        
        if (betContent.Code != 0)
        {
            _logService.Warning("BinggoOrderService", 
                $"è®¢å•è§£æå¤±è´¥ï¼Œæ— æ³•ç»“ç®—: {order.BetContentStandar}");
            order.IsSettled = true;
            order.Profit = 0; // è§£æå¤±è´¥è§†ä¸ºè¾“
            order.NetProfit = -order.AmountTotal;
            order.OrderStatus = OrderStatus.å·²å®Œæˆ;
            return;
        }
        
        // 3. è·å–èµ”ç‡ï¼ˆå‚è€ƒ F5BotV2: _appSetting.wxOddsï¼‰
        float odds = order.Odds > 0 ? order.Odds : 1.97f;
        
        // 4. è°ƒç”¨ OpenLottery è®¡ç®—ç›ˆåˆ©ï¼ˆå‚è€ƒ F5BotV2: order.OpenLottery(data, odds, zsjs)ï¼‰
        float totalWin = 0f; // æ€»èµ¢é‡‘é¢ï¼ˆåŒ…å«æœ¬é‡‘ï¼‰
        foreach (var item in betContent.Items)
        {
            bool isWin = BinggoHelper.IsWin(item, lotteryData);
            if (isWin)
            {
                // ğŸ”¥ å‚è€ƒ F5BotV2: èµ¢äº†è¿”å› é‡‘é¢ Ã— èµ”ç‡
                totalWin += (float)item.TotalAmount * odds;
            }
        }
        
        // 5. æ›´æ–°è®¢å•çŠ¶æ€ï¼ˆå‚è€ƒ F5BotV2: V2MemberOrder.OpenLottery ç¬¬ 172-174 è¡Œï¼‰
        order.Profit = totalWin;  // æ€»èµ¢é‡‘é¢ï¼ˆåŒ…å«æœ¬é‡‘ï¼‰
        order.NetProfit = totalWin - order.AmountTotal;  // çº¯åˆ© = æ€»èµ¢ - æŠ•æ³¨é¢
        order.OrderStatus = OrderStatus.å·²å®Œæˆ;
        order.IsSettled = true;
        
        _logService.Info("BinggoOrderService", 
            $"ğŸ“Š è®¢å•ç»“ç®—: {order.Wxid} - æœŸå· {order.IssueId} - æŠ•æ³¨ {order.AmountTotal:F2} - æ€»èµ¢ {order.Profit:F2} - çº¯åˆ© {order.NetProfit:F2}");
        
        // 6. æ›´æ–°ä¼šå‘˜æ•°æ®ï¼ˆå‚è€ƒ F5BotV2: m.OpenLottery(order) ç¬¬ 451-454 è¡Œï¼‰
        var member = await _memberService.GetMemberByWxidAsync(order.Wxid);
        if (member != null)
        {
            // ğŸ”¥ å…³é”®é€»è¾‘ï¼ˆå‚è€ƒ F5BotV2 V2Member.OpenLotteryï¼‰ï¼š
            // Balance += order.Profit (åŠ ä¸Šæ€»èµ¢é‡‘é¢ï¼ŒåŒ…å«æœ¬é‡‘)
            // IncomeToday += (order.Profit - order.AmountTotal)  (ä»Šæ—¥ç›ˆäº = çº¯åˆ©)
            // IncomeTotal += (order.Profit - order.AmountTotal)  (æ€»ç›ˆäº = çº¯åˆ©)
            
            member.Balance += order.Profit;  // ğŸ”¥ åŠ ä¸Šæ€»èµ¢é‡‘é¢
            member.IncomeToday += order.NetProfit;  // ğŸ”¥ ä»Šæ—¥ç›ˆäºï¼ˆçº¯åˆ©ï¼‰
            member.IncomeTotal += order.NetProfit;  // ğŸ”¥ æ€»ç›ˆäºï¼ˆçº¯åˆ©ï¼‰
            
            // ğŸ”¥ æ‰£é™¤å¾…ç»“ç®—é‡‘é¢ï¼ˆå‚è€ƒ F5BotV2 ç¬¬ 633 è¡Œ: m.BetWait = m.BetWait - order.AmountTotalï¼‰
            member.BetWait -= order.AmountTotal;
            
            _logService.Info("BinggoOrderService", 
                $"âœ… ä¼šå‘˜æ›´æ–°: {member.Nickname} - ä½™é¢ {member.Balance:F2} - ä»Šæ—¥ç›ˆäº {member.IncomeToday:F2} - å¾…ç»“ç®— {member.BetWait:F2}");
        }
        
        await Task.CompletedTask;
    }
    catch (Exception ex)
    {
        _logService.Error("BinggoOrderService", 
            $"è®¢å•ç»“ç®—å¼‚å¸¸: {ex.Message}", ex);
        throw;
    }
}
```

---

### ä¿®å¤ 4ï¼šç›‘å¬ `LotteryOpened` äº‹ä»¶è§¦å‘ç»“ç®—ï¼ˆå‚è€ƒ F5BotV2 ç¬¬ 1434 è¡Œï¼‰

**æ–‡ä»¶**ï¼š`BaiShengVx3Plus/Views/VxMain.cs`

**åœ¨ `InitializeBinggoServices` æ–¹æ³•ä¸­è®¢é˜…äº‹ä»¶ï¼š**

```csharp
private void InitializeBinggoServices()
{
    try
    {
        _logService.Info("VxMain", "åˆå§‹åŒ– Binggo æ¸¸æˆæœåŠ¡...");
        
        // ... å…¶ä»–åˆå§‹åŒ–ä»£ç  ...
        
        // ğŸ”¥ æ–°å¢ï¼šè®¢é˜…å¼€å¥–äº‹ä»¶ï¼Œè§¦å‘ç»“ç®—ï¼ˆå‚è€ƒ F5BotV2 ç¬¬ 1434 è¡Œï¼‰
        _lotteryService.LotteryOpened += OnBinggoLotteryOpened;
        
        _logService.Info("VxMain", "âœ… Binggo æ¸¸æˆæœåŠ¡åˆå§‹åŒ–å®Œæˆ");
    }
    catch (Exception ex)
    {
        _logService.Error("VxMain", $"Binggo æœåŠ¡åˆå§‹åŒ–å¤±è´¥: {ex.Message}", ex);
    }
}

/// <summary>
/// å¼€å¥–äº‹ä»¶å¤„ç†ï¼ˆå‚è€ƒ F5BotV2 çš„ Onå·²å¼€å¥– æ–¹æ³•ï¼‰
/// </summary>
private async void OnBinggoLotteryOpened(object? sender, BinggoLotteryOpenedEventArgs e)
{
    try
    {
        var data = e.LotteryData;
        _logService.Info("VxMain", $"ğŸ² å¼€å¥–äº‹ä»¶è§¦å‘: æœŸå· {data.IssueId} - {data.ToLotteryString()}");
        
        // ğŸ”¥ å‚è€ƒ F5BotV2 ç¬¬ 1434 è¡Œï¼šOnMemberOrderFinish(order, data)
        // è°ƒç”¨è®¢å•æœåŠ¡ç»“ç®—æ‰€æœ‰è¯¥æœŸå·çš„è®¢å•
        var result = await _orderService.SettleOrdersAsync(data.IssueId, data);
        
        _logService.Info("VxMain", $"âœ… ç»“ç®—å®Œæˆ: {result.summary}");
    }
    catch (Exception ex)
    {
        _logService.Error("VxMain", $"å¼€å¥–ç»“ç®—å¼‚å¸¸: {ex.Message}", ex);
    }
}
```

---

## ğŸ”„ å®Œæ•´ä¸šåŠ¡æµç¨‹ï¼ˆä¿®å¤åï¼‰

### æµç¨‹ 1ï¼šç”¨æˆ·ä¸‹æ³¨

```
1ï¸âƒ£ ç”¨æˆ·å‘é€ï¼š"6å¤§50"
   â†“
2ï¸âƒ£ BinggoOrderService.CreateOrderAsync
   â”œâ”€ è§£æä¸‹æ³¨å†…å®¹ âœ…
   â”œâ”€ æ ¡éªŒä½™é¢ âœ…
   â”œâ”€ åˆ›å»ºè®¢å•ï¼ˆOrderStatus = å¾…ç»“ç®—ï¼‰âœ…
   â”œâ”€ æ‰£é™¤ä½™é¢ï¼šmember.Balance -= 50 âœ…
   â”œâ”€ ğŸ”¥ å¢åŠ å¾…ç»“ç®—ï¼šmember.BetWait += 50 âœ…
   â”œâ”€ ğŸ”¥ å¢åŠ ä»Šæ—¥ä¸‹æ³¨ï¼šmember.BetToday += 50 âœ…
   â””â”€ ä¿å­˜è®¢å•åˆ°æ•°æ®åº“ âœ…
   â†“
3ï¸âƒ£ ç”Ÿæˆå›å¤æ¶ˆæ¯ï¼ˆğŸ”¥ F5BotV2 æ ¼å¼ï¼‰
   "@å¼ ä¸‰\rå·²è¿›ä»“1\r6å¤§|æ‰£:50|ç•™:950" âœ…
   â†“
4ï¸âƒ£ å‘é€åˆ°å¾®ä¿¡ç¾¤ âœ…
```

---

### æµç¨‹ 2ï¼šå¼€å¥–ç»“ç®—

```
1ï¸âƒ£ BinggoLotteryService æ£€æµ‹åˆ°å¼€å¥–æ•°æ®
   â”œâ”€ è§¦å‘ LotteryOpened äº‹ä»¶ âœ…
   â†“
2ï¸âƒ£ VxMain.OnBinggoLotteryOpened æ¥æ”¶äº‹ä»¶
   â”œâ”€ è°ƒç”¨ _orderService.SettleOrdersAsync(issueId, data) âœ…
   â†“
3ï¸âƒ£ BinggoOrderService.SettleOrdersAsync
   â”œâ”€ æŸ¥è¯¢æ‰€æœ‰ IssueId = 114062935 ä¸” IsSettled = false çš„è®¢å• âœ…
   â”œâ”€ é€ä¸ªè°ƒç”¨ SettleSingleOrderAsync âœ…
   â†“
4ï¸âƒ£ SettleSingleOrderAsyncï¼ˆå•ä¸ªè®¢å•ï¼‰
   â”œâ”€ è§£æ BetContentStandarï¼š"6å¤§50" âœ…
   â”œâ”€ è·å–èµ”ç‡ï¼š1.97 âœ…
   â”œâ”€ åˆ¤æ–­è¾“èµ¢ï¼šBinggoHelper.IsWin(item, lotteryData) âœ…
   â”œâ”€ è®¡ç®—ç›ˆåˆ©ï¼š
   â”‚  â”œâ”€ å¦‚æœèµ¢ï¼štotalWin = 50 Ã— 1.97 = 98.5 âœ…
   â”‚  â”œâ”€ å¦‚æœè¾“ï¼štotalWin = 0 âœ…
   â”‚  â””â”€ NetProfit = totalWin - 50 âœ…
   â”œâ”€ æ›´æ–°è®¢å•ï¼š
   â”‚  â”œâ”€ order.Profit = 98.5 âœ…
   â”‚  â”œâ”€ order.NetProfit = 48.5 âœ…
   â”‚  â”œâ”€ order.OrderStatus = å·²å®Œæˆ âœ…
   â”‚  â””â”€ order.IsSettled = true âœ…
   â”œâ”€ ğŸ”¥ æ›´æ–°ä¼šå‘˜ï¼š
   â”‚  â”œâ”€ member.Balance += 98.5  (åŠ ä¸Šæ€»èµ¢é‡‘é¢) âœ…
   â”‚  â”œâ”€ member.IncomeToday += 48.5  (ä»Šæ—¥ç›ˆäº = çº¯åˆ©) âœ…
   â”‚  â”œâ”€ member.IncomeTotal += 48.5  (æ€»ç›ˆäº = çº¯åˆ©) âœ…
   â”‚  â””â”€ member.BetWait -= 50  (æ‰£é™¤å¾…ç»“ç®—) âœ…
   â†“
5ï¸âƒ£ æ•°æ®è‡ªåŠ¨ä¿å­˜åˆ°æ•°æ®åº“ï¼ˆé€šè¿‡ BindingListï¼‰âœ…
   â†“
6ï¸âƒ£ UI è‡ªåŠ¨åˆ·æ–°ï¼ˆé€šè¿‡ INotifyPropertyChangedï¼‰âœ…
```

---

## ğŸ“Š å­—æ®µå¯¹ç…§è¡¨

| å­—æ®µ | F5BotV2 | BaiShengVx3Plus | è¯´æ˜ |
|------|---------|-----------------|------|
| **Balance** | âœ… | âœ… | ä½™é¢ |
| **BetWait** | âœ… | âœ… | å¾…ç»“ç®—é‡‘é¢ï¼ˆè·¨æœŸç´¯è®¡ï¼‰ |
| **BetCur** | âœ… | âœ… | æœ¬æœŸä¸‹æ³¨ï¼ˆæ¯æœŸæ¸…é›¶ï¼‰ |
| **BetToday** | âœ… | âœ… | ä»Šæ—¥ä¸‹æ³¨æ€»é¢ |
| **BetTotal** | âœ… | âœ… | æ€»ä¸‹æ³¨é¢ |
| **IncomeToday** | âœ… | âœ… | ä»Šæ—¥ç›ˆäºï¼ˆçº¯åˆ©ï¼‰ |
| **IncomeTotal** | âœ… | âœ… | æ€»ç›ˆäºï¼ˆçº¯åˆ©ï¼‰ |
| **CreditToday** | âœ… | âœ… | ä»Šæ—¥ä¸Šåˆ† |
| **WithdrawToday** | âœ… | âœ… | ä»Šæ—¥ä¸‹åˆ† |

**å…³é”®åŒºåˆ«**ï¼š
- `BetWait` = æ‰€æœ‰æœªç»“ç®—è®¢å•çš„æŠ•æ³¨æ€»é¢ï¼ˆä¼šè·¨æœŸç´¯è®¡ï¼‰
- `BetCur` = å½“å‰æœŸå·çš„æŠ•æ³¨æ€»é¢ï¼ˆæ¯æœŸæ¸…é›¶ï¼‰
- `IncomeToday` = ä»Šæ—¥å‡€åˆ©æ¶¦ï¼ˆProfit - AmountTotalï¼‰

---

## ğŸ§ª æµ‹è¯•å»ºè®®

### æµ‹è¯•åœºæ™¯ 1ï¼šä¸‹æ³¨å’Œå›å¤æ ¼å¼

1. åœ¨å¾®ä¿¡ç¾¤å‘é€ï¼š`6å¤§50`
2. æ£€æŸ¥ä¼šå‘˜è¡¨ï¼š
   - âœ… `Balance` å‡å°‘ 50
   - âœ… `BetWait` å¢åŠ  50
   - âœ… `BetToday` å¢åŠ  50
3. æ£€æŸ¥å¾®ä¿¡å›å¤ï¼š
   ```
   @å¼ ä¸‰
   å·²è¿›ä»“1
   6å¤§|æ‰£:50|ç•™:950
   ```

---

### æµ‹è¯•åœºæ™¯ 2ï¼šå¼€å¥–ç»“ç®—ï¼ˆèµ¢ï¼‰

å‡è®¾ï¼š
- ç”¨æˆ·ä¸‹æ³¨ "6å¤§50"
- å¼€å¥–ç»“æœï¼šPæ€» = 88ï¼ˆå¤§ï¼‰
- èµ”ç‡ï¼š1.97

**é¢„æœŸç»“æœ**ï¼š
1. è®¢å•è¡¨ï¼š
   - âœ… `Profit` = 98.5 (50 Ã— 1.97)
   - âœ… `NetProfit` = 48.5 (98.5 - 50)
   - âœ… `OrderStatus` = å·²å®Œæˆ
2. ä¼šå‘˜è¡¨ï¼š
   - âœ… `Balance` å¢åŠ  98.5 ï¼ˆä» 900 â†’ 998.5ï¼‰
   - âœ… `BetWait` å‡å°‘ 50 ï¼ˆä» 50 â†’ 0ï¼‰
   - âœ… `IncomeToday` å¢åŠ  48.5
   - âœ… `IncomeTotal` å¢åŠ  48.5

---

### æµ‹è¯•åœºæ™¯ 3ï¼šå¼€å¥–ç»“ç®—ï¼ˆè¾“ï¼‰

å‡è®¾ï¼š
- ç”¨æˆ·ä¸‹æ³¨ "6å¤§50"
- å¼€å¥–ç»“æœï¼šPæ€» = 42ï¼ˆå°ï¼‰
- èµ”ç‡ï¼š1.97

**é¢„æœŸç»“æœ**ï¼š
1. è®¢å•è¡¨ï¼š
   - âœ… `Profit` = 0
   - âœ… `NetProfit` = -50 (0 - 50)
   - âœ… `OrderStatus` = å·²å®Œæˆ
2. ä¼šå‘˜è¡¨ï¼š
   - âœ… `Balance` ä¸å˜ ï¼ˆä»ä¸º 900ï¼Œå› ä¸ºä¸‹æ³¨æ—¶å·²æ‰£é™¤ï¼‰
   - âœ… `BetWait` å‡å°‘ 50 ï¼ˆä» 50 â†’ 0ï¼‰
   - âœ… `IncomeToday` å‡å°‘ 50
   - âœ… `IncomeTotal` å‡å°‘ 50

---

## âœ… å¾…å®ç°æ¸…å•

- [x] ä¿®å¤ä¸‹æ³¨å›å¤æ ¼å¼ï¼ˆF5BotV2 æ ¼å¼ï¼‰
- [ ] ä¸‹æ³¨æ—¶å¢åŠ  `BetWait`
- [ ] ç»“ç®—æ—¶æ›´æ–°ä¼šå‘˜ç»Ÿè®¡ï¼ˆBalance, IncomeToday, IncomeTotal, BetWaitï¼‰
- [ ] åœ¨ VxMain ä¸­è®¢é˜… `LotteryOpened` äº‹ä»¶è§¦å‘ç»“ç®—
- [ ] æµ‹è¯•å®Œæ•´æµç¨‹

---

**ğŸ‰ å®ç°è¿™äº›ä¿®å¤åï¼Œç³»ç»Ÿå°†å®Œå…¨ç¬¦åˆ F5BotV2 çš„ä¸šåŠ¡é€»è¾‘ï¼**

