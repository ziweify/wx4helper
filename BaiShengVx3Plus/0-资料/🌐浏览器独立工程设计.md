# ğŸŒ æµè§ˆå™¨ç‹¬ç«‹å·¥ç¨‹è®¾è®¡

## ğŸ’¡ æ ¸å¿ƒæ€æƒ³

**æµè§ˆå™¨æ˜¯ç‹¬ç«‹çš„å·¥ç¨‹ï¼Œé€šè¿‡ Socket ä¸ä¸»ç¨‹åºé€šä¿¡**

å°±åƒ `WeixinX` (C++) å’Œ `BaiShengVx3Plus` (C#) é€šè¿‡ Socket é€šä¿¡ä¸€æ ·ï¼

---

## ğŸ—ï¸ æ•´ä½“æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   BaiShengVx3Plus (ä¸»ç¨‹åº)           â”‚
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚  AutoBetService          â”‚      â”‚
â”‚  â”‚  â€¢ ç®¡ç†é…ç½®              â”‚      â”‚
â”‚  â”‚  â€¢ å¯åŠ¨æµè§ˆå™¨è¿›ç¨‹         â”‚      â”‚
â”‚  â”‚  â€¢ å‘é€æŠ•æ³¨å‘½ä»¤           â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚            â”‚                        â”‚
â”‚            â”‚ Socket é€šä¿¡             â”‚
â”‚            â†“                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â”‚ TCP Socket (JSON åè®®)
             â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   BsBrowserClient (ç‹¬ç«‹å·¥ç¨‹)        â”‚
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚  Form1 (ä¸»çª—ä½“)           â”‚      â”‚
â”‚  â”‚  â€¢ CEF æµè§ˆå™¨æ§ä»¶         â”‚      â”‚
â”‚  â”‚  â€¢ çŠ¶æ€æ                  â”‚      â”‚
â”‚  â”‚  â€¢ æ—¥å¿—é¢æ¿               â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚            â†‘                        â”‚
â”‚            â”‚                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚  SocketServer            â”‚      â”‚
â”‚  â”‚  â€¢ ç›‘å¬ç«¯å£               â”‚      â”‚
â”‚  â”‚  â€¢ æ¥æ”¶å‘½ä»¤               â”‚      â”‚
â”‚  â”‚  â€¢ è¿”å›ç»“æœ               â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚            â†“                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚  PlatformScripts          â”‚      â”‚
â”‚  â”‚  â€¢ YunDing28Script        â”‚      â”‚
â”‚  â”‚  â€¢ HaiXia28Script         â”‚      â”‚
â”‚  â”‚  â€¢ ... å…¶ä»–å¹³å°           â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“¡ é€šä¿¡åè®®

### å‘½ä»¤ç±»å‹

| å‘½ä»¤ | è¯´æ˜ | å‚æ•° |
|------|------|------|
| `Navigate` | å¯¼èˆªåˆ°URL | `Url` |
| `Login` | ç™»å½• | `Username`, `Password`, `Platform` |
| `GetBalance` | è·å–ä½™é¢ | - |
| `PlaceBet` | æŠ•æ³¨ | `IssueId`, `PlayType`, `BetContent`, `Amount` |
| `GetStatus` | è·å–çŠ¶æ€ | - |
| `Stop` | åœæ­¢æµè§ˆå™¨ | - |

### è¯·æ±‚æ ¼å¼

```json
{
  "Command": "Login",
  "Data": {
    "Username": "test001",
    "Password": "aaa111",
    "Platform": "YunDing28"
  }
}
```

### å“åº”æ ¼å¼

```json
{
  "Success": true,
  "Data": {
    "Balance": 1000.50,
    "OrderId": "202311070001"
  },
  "ErrorMessage": null
}
```

---

## ğŸš€ å¯åŠ¨æµç¨‹

### 1. ä¸»ç¨‹åºå¯åŠ¨æµè§ˆå™¨

```csharp
// BaiShengVx3Plus/Services/AutoBet/AutoBetService.cs

public async Task<bool> StartBrowser(int configId)
{
    var config = GetConfig(configId);
    
    // 1. åˆ†é…ç«¯å£
    var port = GetAvailablePort();
    
    // 2. å¯åŠ¨æµè§ˆå™¨è¿›ç¨‹
    var process = new Process
    {
        StartInfo = new ProcessStartInfo
        {
            FileName = "BsBrowserClient.exe",
            Arguments = $"--config-id {configId} --port {port} --platform {config.Platform}",
            UseShellExecute = false,
            CreateNoWindow = !config.ShowBrowserWindow
        }
    };
    process.Start();
    
    // 3. è¿æ¥ Socket
    var client = new BrowserClient(port);
    await client.Connect();
    
    // 4. ç™»å½•
    await client.SendCommand("Login", new { 
        Username = config.Username, 
        Password = config.Password 
    });
    
    _browsers[configId] = client;
    return true;
}
```

### 2. æµè§ˆå™¨æ¥æ”¶å‘½ä»¤

```csharp
// BsBrowserClient/SocketServer.cs

private async Task HandleClient(TcpClient client)
{
    var stream = client.GetStream();
    var reader = new StreamReader(stream);
    var writer = new StreamWriter(stream);
    
    while (true)
    {
        var json = await reader.ReadLineAsync();
        var request = JsonConvert.DeserializeObject<Request>(json);
        
        // æ‰§è¡Œå‘½ä»¤
        var result = await ExecuteCommand(request);
        
        // è¿”å›ç»“æœ
        var response = JsonConvert.SerializeObject(result);
        await writer.WriteLineAsync(response);
        await writer.FlushAsync();
    }
}
```

---

## ğŸ¨ æµè§ˆå™¨ç•Œé¢è®¾è®¡

### Form1.cs (ä¸»çª—ä½“)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç™¾ç››æµè§ˆå™¨ - äº‘é¡¶28 (é…ç½®ID: 1)          [_][â–¡][Ã—]â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ åœ°å€: https://www.yunding28.com    [åˆ·æ–°] [è®¾ç½®] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                 â”‚
â”‚                                                 â”‚
â”‚         CEF æµè§ˆå™¨æ§ä»¶                           â”‚
â”‚         (chromiumWebBrowser1)                   â”‚
â”‚                                                 â”‚
â”‚                                                 â”‚
â”‚                                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ çŠ¶æ€: â— å·²ç™»å½•  |  ä½™é¢: Â¥1,234.56  |  ç«¯å£: 9527â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æ§ä»¶åˆ—è¡¨**:
- `chromiumWebBrowser1`: CefSharp.WinForms.ChromiumWebBrowser
- `txtUrl`: TextBox (åœ°å€æ )
- `btnRefresh`: Button (åˆ·æ–°)
- `btnSettings`: Button (è®¾ç½®)
- `statusStrip1`: StatusStrip (çŠ¶æ€æ )
- `lblStatus`: ToolStripStatusLabel (çŠ¶æ€)
- `lblBalance`: ToolStripStatusLabel (ä½™é¢)
- `lblPort`: ToolStripStatusLabel (ç«¯å£)

---

## ğŸ“¦ é¡¹ç›®ç»“æ„

```
BsBrowserClient/
â”œâ”€â”€ Form1.cs                    // ä¸»çª—ä½“ (Designer è®¾è®¡)
â”œâ”€â”€ Form1.Designer.cs
â”œâ”€â”€ Form1.resx
â”œâ”€â”€ Program.cs                  // å…¥å£
â”œâ”€â”€ Models/
â”‚   â”œâ”€â”€ Request.cs             // è¯·æ±‚æ¨¡å‹
â”‚   â”œâ”€â”€ Response.cs            // å“åº”æ¨¡å‹
â”‚   â””â”€â”€ BetOrder.cs            // æŠ•æ³¨è®¢å•
â”œâ”€â”€ Services/
â”‚   â”œâ”€â”€ SocketServer.cs        // Socket æœåŠ¡å™¨
â”‚   â””â”€â”€ BrowserService.cs      // æµè§ˆå™¨æ“ä½œå°è£…
â””â”€â”€ PlatformScripts/
    â”œâ”€â”€ IPlatformScript.cs     // å¹³å°è„šæœ¬æ¥å£
    â”œâ”€â”€ YunDing28Script.cs     // äº‘é¡¶28
    â”œâ”€â”€ HaiXia28Script.cs      // æµ·å³¡28
    â””â”€â”€ ...
```

---

## ğŸ”„ æ•°æ®æµè½¬

### æŠ•æ³¨æµç¨‹

```
1. ç”¨æˆ·åœ¨ä¸»ç¨‹åºä¸­ç‚¹å‡»æŠ•æ³¨
   â†“
2. AutoBetService.PlaceBet(configId, order)
   â†“
3. BrowserClient.SendCommand("PlaceBet", order)
   â†“
4. Socket å‘é€ JSON åˆ° BsBrowserClient
   â†“
5. SocketServer æ¥æ”¶å‘½ä»¤
   â†“
6. æ ¹æ® Platform é€‰æ‹©è„šæœ¬ (switch)
   â†“
7. YunDing28Script.PlaceBet(order)
   â†“
8. æ³¨å…¥ JavaScript åˆ°æµè§ˆå™¨
   â†“
9. è·å–æŠ•æ³¨ç»“æœ
   â†“
10. è¿”å› JSON å“åº”
    â†“
11. BrowserClient æ¥æ”¶ç»“æœ
    â†“
12. AutoBetService ä¿å­˜è®¢å•è®°å½•
```

---

## âœ… ä¼˜åŠ¿

1. **éš”ç¦»æ€§**: æµè§ˆå™¨å´©æºƒä¸å½±å“ä¸»ç¨‹åº
2. **å¤šå®ä¾‹**: å¯ä»¥å¯åŠ¨å¤šä¸ªæµè§ˆå™¨è¿›ç¨‹
3. **ç‹¬ç«‹å¼€å‘**: æµè§ˆå™¨å’Œä¸»ç¨‹åºå¯ä»¥ç‹¬ç«‹å¼€å‘æµ‹è¯•
4. **å¯æ‰©å±•**: æ–°å¢å¹³å°åªéœ€æ·»åŠ è„šæœ¬ç±»
5. **æ˜“è°ƒè¯•**: å¯ä»¥å•ç‹¬è¿è¡Œæµè§ˆå™¨è¿›è¡Œè°ƒè¯•

---

## ğŸ“‹ å¼€å‘æ­¥éª¤

### Step 1: å®Œå–„ BsBrowserClient å·¥ç¨‹
1. ä½¿ç”¨ Designer è®¾è®¡ä¸»çª—ä½“ç•Œé¢
2. æ·»åŠ  CefSharp åŒ…å¼•ç”¨
3. å®ç° SocketServer
4. å®ç°å¹³å°è„šæœ¬

### Step 2: å®Œå–„ BaiShengVx3Plus å·¥ç¨‹
1. å®ç° BrowserClient å°è£…ç±» (Socket å®¢æˆ·ç«¯)
2. æ›´æ–° AutoBetService ä½¿ç”¨ Socket é€šä¿¡
3. æ·»åŠ è¿›ç¨‹ç®¡ç†åŠŸèƒ½

### Step 3: è”è°ƒæµ‹è¯•
1. å…ˆå•ç‹¬æµ‹è¯• BsBrowserClient
2. æµ‹è¯• Socket é€šä¿¡
3. æµ‹è¯•å®Œæ•´æŠ•æ³¨æµç¨‹

---

**è¿™æ‰æ˜¯æ­£ç¡®çš„è®¾è®¡ï¼ç®€å•ã€ç‹¬ç«‹ã€æ˜“ç»´æŠ¤ï¼** âœ¨

