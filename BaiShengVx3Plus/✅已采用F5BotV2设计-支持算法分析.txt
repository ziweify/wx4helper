========================================
  âœ… å·²é‡‡ç”¨ F5BotV2 è®¾è®¡ï¼æ”¯æŒç®—æ³•åˆ†æ
========================================

æ›´æ–°æ—¥æœŸ: 2025-11-06
ç›®çš„: é‡‡ç”¨ F5BotV2 çš„ç²¾å¦™è®¾è®¡ï¼Œä¸ºåæœŸç®—æ³•åˆ†ææ‰“å¥½åŸºç¡€
çŠ¶æ€: âœ… å·²å®Œæˆ

========================================
  ğŸ¯ è®¾è®¡ç†å¿µ
========================================

### æ‚¨çš„æŒ‡å¯¼ï¼ˆéå¸¸æ­£ç¡®ï¼ï¼‰

"æˆ‘å»ºè®®ä½¿ç”¨å®ƒçš„æ¨¡å‹ï¼Œä½¿ç”¨å®ƒçš„å…ƒç´ ï¼Œä½ å¯ä»¥æ›´åŠ ä¼˜åŒ–ï¼Œåå­—ä¹Ÿå¯ä»¥ã€‚
åæœŸåšç®—æ³•çš„æ—¶å€™ï¼Œä¼šç”¨åˆ°æ¯ä¸ªå…ƒç´ çš„å±æ€§ã€‚"

### F5BotV2 è®¾è®¡çš„ç²¾é«“

**æ ¸å¿ƒæ€æƒ³**ï¼š
æ¯ä¸ªå¼€å¥–å·ç ä¸ä»…ä»…æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œè€Œæ˜¯ä¸€ä¸ªåŒ…å«å¤šä¸ªå±æ€§çš„å¯¹è±¡ï¼

```
å·ç  7 ä¸æ˜¯ç®€å•çš„ int 7ï¼Œè€Œæ˜¯ï¼š
- Number: 7
- Size: å°ï¼ˆâ‰¤40ï¼‰
- OddEven: å•
- TailSize: å°¾å°ï¼ˆå°¾æ•°7ï¼Œä½†å®é™…æ˜¯çœ‹ä¸ªä½ï¼‰
- SumOddEven: åˆå•ï¼ˆ0+7=7ï¼‰
- Position: P1
```

**ä¸ºä»€ä¹ˆè¿™æ ·è®¾è®¡ï¼Ÿ**
- ç®—æ³•åˆ†æéœ€è¦ç»Ÿè®¡"å¤§å°"ã€"å•åŒ"ã€"å°¾å¤§å°"ã€"åˆå•åŒ"
- é¾™è™ã€æ€»å’Œéƒ½æœ‰è‡ªå·±çš„å±æ€§
- åæœŸåšèµ°åŠ¿å›¾ã€çƒ­åº¦åˆ†æã€æ¦‚ç‡è®¡ç®—æ—¶éå¸¸æ–¹ä¾¿

---

========================================
  âœ… æ–°çš„æ¨¡å‹è®¾è®¡
========================================

### 1. LotteryNumberï¼ˆå·ç å¯¹è±¡ï¼‰

**æ–‡ä»¶**ï¼š`BaiShengVx3Plus/Models/Games/Binggo/LotteryNumber.cs`

**æ ¸å¿ƒå±æ€§**ï¼š
```csharp
public class LotteryNumber
{
    public int Number { get; set; }              // å·ç å€¼ï¼ˆ1-28ï¼‰
    public SizeType Size { get; set; }           // å¤§å°
    public OddEvenType OddEven { get; set; }     // å•åŒ
    public TailSizeType TailSize { get; set; }   // å°¾å¤§å°
    public SumOddEvenType SumOddEven { get; set; } // åˆå•åŒ
    public BallPosition Position { get; set; }   // ä½ç½®ï¼ˆP1-P5 æˆ– Sumï¼‰
}
```

**è®¡ç®—è§„åˆ™**ï¼ˆå®Œå…¨å‚è€ƒ F5BotV2ï¼‰ï¼š

#### å¤§å°åˆ¤æ–­
```csharp
// å•ä¸ªçƒï¼š>40ä¸ºå¤§ï¼Œâ‰¤40ä¸ºå°
if (position != BallPosition.Sum)
{
    Size = (number > 40) ? SizeType.Big : SizeType.Small;
}
// æ€»å’Œï¼š>=203ä¸ºå¤§ï¼Œ15-202ä¸ºå°
else
{
    if (number >= 15 && number <= 202)
        Size = SizeType.Small;
    else if (number >= 203 && number <= 390)
        Size = SizeType.Big;
}
```

#### å•åŒåˆ¤æ–­
```csharp
OddEven = (number % 2 == 0) ? OddEvenType.Even : OddEvenType.Odd;
```

#### å°¾å¤§å°åˆ¤æ–­
```csharp
int tailDigit = number % 10;  // å°¾æ•°
TailSize = (tailDigit >= 0 && tailDigit <= 4) ? TailSizeType.TailSmall : TailSizeType.TailBig;
```

#### åˆå•åŒåˆ¤æ–­ï¼ˆåä½+ä¸ªä½çš„å’Œï¼‰
```csharp
int tenDigit = number / 10;
int digitSum = tenDigit + tailDigit;
SumOddEven = (digitSum % 2 == 0) ? SumOddEvenType.SumEven : SumOddEvenType.SumOdd;

// ç‰¹æ®Šï¼šå¦‚æœæ˜¯æ€»å’Œï¼Œåˆå•åŒç­‰äºå•åŒ
if (position == BallPosition.Sum)
{
    SumOddEven = (OddEven == OddEvenType.Even) ? SumOddEvenType.SumEven : SumOddEvenType.SumOdd;
}
```

---

### 2. BinggoLotteryDataï¼ˆå¼€å¥–æ•°æ®ï¼‰

**æ–‡ä»¶**ï¼š`BaiShengVx3Plus/Models/Games/Binggo/BinggoLotteryData.cs`

**æ ¸å¿ƒå±æ€§**ï¼š
```csharp
public class BinggoLotteryData
{
    // ğŸ”¥ æ•°æ®åº“å­—æ®µ
    public int IssueId { get; set; }              // æœŸå·
    public string LotteryData { get; set; }       // "7,14,21,8,2"
    public string OpenTime { get; set; }          // "2025-11-06 21:00:00"
    
    // ğŸ”¥ è®¡ç®—å±æ€§ï¼ˆä¸å­˜å‚¨åˆ°æ•°æ®åº“ï¼‰
    public List<LotteryNumber> Items { get; }     // å·ç åˆ—è¡¨
    public LotteryNumber? P1 { get; }             // ç¬¬1çƒ
    public LotteryNumber? P2 { get; }             // ç¬¬2çƒ
    public LotteryNumber? P3 { get; }             // ç¬¬3çƒ
    public LotteryNumber? P4 { get; }             // ç¬¬4çƒ
    public LotteryNumber? P5 { get; }             // ç¬¬5çƒ
    public LotteryNumber? PSum { get; }           // æ€»å’Œ
    public DragonTigerType DragonTiger { get; }   // é¾™è™
}
```

**æ ¸å¿ƒæ–¹æ³•**ï¼ˆå®Œå…¨å‚è€ƒ F5BotV2ï¼‰ï¼š
```csharp
// ğŸ”¥ å¡«å……æ•°æ®ï¼ˆä¸ F5BotV2 çš„ FillLotteryData ä¸€è‡´ï¼‰
public BinggoLotteryData FillLotteryData(int issueId, string lotteryData, string openTime)
{
    IssueId = issueId;
    LotteryData = lotteryData;
    OpenTime = openTime;
    // è‡ªåŠ¨è§£æå·ç ï¼Œåˆ›å»º LotteryNumber å¯¹è±¡
    return this;
}

// ğŸ”¥ æ ¹æ®ä½ç½®è·å–å·ç ï¼ˆä¸ F5BotV2 çš„ GetCarNumber ä¸€è‡´ï¼‰
public LotteryNumber? GetBallNumber(BallPosition position)
{
    return position switch
    {
        BallPosition.P1 => P1,
        BallPosition.P2 => P2,
        // ...
    };
}

// ğŸ”¥ è½¬æ¢ä¸ºæ˜¾ç¤ºå­—ç¬¦ä¸²ï¼ˆä¸ F5BotV2 çš„ ToLotteryString ä¸€è‡´ï¼‰
public string ToLotteryString()
{
    // è¾“å‡ºï¼š7,14,21,8,2 å°å• é¾™
    return $"{P1.Number},{P2.Number},{P3.Number},{P4.Number},{P5.Number} " +
           $"{PSum.GetSizeText()}{PSum.GetOddEvenText()} " +
           $"{GetDragonTigerText()}";
}
```

---

========================================
  ğŸ¯ ç®—æ³•åˆ†æç¤ºä¾‹
========================================

### ç¤ºä¾‹æ•°æ®

```
æœŸå·: 114062884
å¼€å¥–: 7,14,21,8,2
```

**å®Œæ•´è§£æå**ï¼š
```csharp
P1: 7  [å°å•, å°¾å°, åˆå•]
P2: 14 [å°åŒ, å°¾å°, åˆå•]
P3: 21 [å°å•, å°¾å°, åˆå•]
P4: 8  [å°åŒ, å°¾å¤§, åˆåŒ]
P5: 2  [å°åŒ, å°¾å°, åˆå•]
PSum: 52 [å°åŒ]
é¾™è™: é¾™ï¼ˆP1=7 > P5=2ï¼‰
```

---

### ç®—æ³•åˆ†æåœºæ™¯

#### åœºæ™¯ 1: ç»Ÿè®¡å¤§å°åˆ†å¸ƒ

```csharp
var recentData = await _lotteryService.GetRecentLotteryDataAsync(100);

// ç»Ÿè®¡ P1 çš„å¤§å°åˆ†å¸ƒ
var p1BigCount = recentData.Count(d => d.P1?.Size == SizeType.Big);
var p1SmallCount = recentData.Count(d => d.P1?.Size == SizeType.Small);

Console.WriteLine($"P1 å¤§: {p1BigCount}, å°: {p1SmallCount}");
```

#### åœºæ™¯ 2: ç»Ÿè®¡é¾™è™èµ°åŠ¿

```csharp
var dragonCount = recentData.Count(d => d.DragonTiger == DragonTigerType.Dragon);
var tigerCount = recentData.Count(d => d.DragonTiger == DragonTigerType.Tiger);

Console.WriteLine($"é¾™: {dragonCount}, è™: {tigerCount}");
```

#### åœºæ™¯ 3: ç»Ÿè®¡å°¾å¤§å°çƒ­åº¦

```csharp
// ç»Ÿè®¡ P1 å°¾å¤§å°è¿ç»­å‡ºç°æ¬¡æ•°
int continuousTailBig = 0;
foreach (var data in recentData.OrderByDescending(d => d.IssueId))
{
    if (data.P1?.TailSize == TailSizeType.TailBig)
        continuousTailBig++;
    else
        break;
}

Console.WriteLine($"P1 å°¾å¤§å·²è¿ç»­å‡ºç° {continuousTailBig} æœŸ");
```

#### åœºæ™¯ 4: ç»Ÿè®¡åˆå•åŒè¶‹åŠ¿

```csharp
// ç»Ÿè®¡æœ€è¿‘ 10 æœŸ P1 çš„åˆå•åŒ
var recent10 = recentData.Take(10).OrderByDescending(d => d.IssueId);
foreach (var data in recent10)
{
    Console.WriteLine($"æœŸå· {data.IssueId}, P1={data.P1?.Number}, åˆå•åŒ={data.P1?.GetSumOddEvenText()}");
}
```

#### åœºæ™¯ 5: æ€»å’Œåˆ†æ

```csharp
// ç»Ÿè®¡æ€»å’ŒèŒƒå›´åˆ†å¸ƒ
var sumDistribution = recentData
    .GroupBy(d => d.PSum?.Number / 50)  // æŒ‰50åˆ†ç»„ï¼š0-49, 50-99, ...
    .Select(g => new { Range = g.Key * 50, Count = g.Count() })
    .OrderBy(x => x.Range);

foreach (var item in sumDistribution)
{
    Console.WriteLine($"æ€»å’Œ {item.Range}-{item.Range + 49}: {item.Count} æœŸ");
}
```

---

========================================
  ğŸ“Š å¯¹æ¯” F5BotV2
========================================

| é¡¹ç›® | F5BotV2 | BaiShengVx3Plus | çŠ¶æ€ |
|------|---------|----------------|------|
| **æ¨¡å‹åç§°** | `BgLotteryData` | `BinggoLotteryData` | âœ… |
| **å·ç å¯¹è±¡** | `LotteryNumber` | `LotteryNumber` | âœ… |
| **æœŸå·å­—æ®µ** | `IssueId` | `IssueId` | âœ… |
| **å·ç å­—ç¬¦ä¸²** | `lotteryData` | `LotteryData` | âœ… |
| **å¼€å¥–æ—¶é—´** | `opentime` (string) | `OpenTime` (string) | âœ… |
| **P1-P5** | `LotteryNumber` | `LotteryNumber` | âœ… |
| **æ€»å’Œ** | `Pæ€»` | `PSum` | âœ… |
| **é¾™è™** | `Pé¾™è™` | `DragonTiger` | âœ… |
| **å·ç åˆ—è¡¨** | `items` | `Items` | âœ… |
| **å¡«å……æ–¹æ³•** | `FillLotteryData()` | `FillLotteryData()` | âœ… |
| **è·å–å·ç ** | `GetCarNumber()` | `GetBallNumber()` | âœ… |
| **è½¬æ¢å­—ç¬¦ä¸²** | `ToLotteryString()` | `ToLotteryString()` | âœ… |

### å±æ€§å¯¹æ¯”

| å±æ€§ | F5BotV2 | BaiShengVx3Plus | è¯´æ˜ |
|------|---------|----------------|------|
| å¤§å° | `dx` (NumberDX) | `Size` (SizeType) | âœ… é€»è¾‘ä¸€è‡´ |
| å•åŒ | `ds` (NumberDS) | `OddEven` (OddEvenType) | âœ… é€»è¾‘ä¸€è‡´ |
| å°¾å¤§å° | `wdx` (NumberWDX) | `TailSize` (TailSizeType) | âœ… é€»è¾‘ä¸€è‡´ |
| åˆå•åŒ | `hds` (NumberHDS) | `SumOddEven` (SumOddEvenType) | âœ… é€»è¾‘ä¸€è‡´ |
| ä½ç½® | `pos` (CarNumEnum) | `Position` (BallPosition) | âœ… é€»è¾‘ä¸€è‡´ |

---

========================================
  ğŸ¯ ä¼˜åŒ–ç‚¹
========================================

### 1. å‘½åæ›´ç°ä»£åŒ–

**F5BotV2**ï¼š
- `dx`, `ds`, `wdx`, `hds`ï¼ˆç¼©å†™ï¼‰
- `Pæ€»`, `Pé¾™è™`ï¼ˆä¸­æ–‡ï¼‰

**BaiShengVx3Plus**ï¼š
- `Size`, `OddEven`, `TailSize`, `SumOddEven`ï¼ˆå®Œæ•´å•è¯ï¼‰
- `PSum`, `DragonTiger`ï¼ˆè‹±æ–‡ï¼‰

**ä¼˜ç‚¹**ï¼š
- âœ… æ›´æ˜“äºç†è§£
- âœ… æ›´ç¬¦åˆç°ä»£ C# å‘½åè§„èŒƒ
- âœ… è‹±æ–‡å‘½åä¾¿äºå›½é™…åŒ–

---

### 2. ç±»å‹å®‰å…¨

**F5BotV2**ï¼š
```csharp
public enum NumberDX { æœªçŸ¥ = 3, å° = 0, å¤§ = 1}
```

**BaiShengVx3Plus**ï¼š
```csharp
public enum SizeType
{
    Unknown = -1,
    Small = 0,   // å°
    Big = 1      // å¤§
}
```

**ä¼˜ç‚¹**ï¼š
- âœ… `Unknown = -1` æ›´åˆç†ï¼ˆ0å’Œ1ä»£è¡¨å®é™…å€¼ï¼‰
- âœ… è‹±æ–‡æšä¸¾å€¼æ›´æ ‡å‡†
- âœ… æ³¨é‡Šè¯´æ˜ä¸­æ–‡å«ä¹‰

---

### 3. å±æ€§å°è£…

**F5BotV2**ï¼š
```csharp
[Ignore]
public LotteryNumber P1 { get; set; }
```

**BaiShengVx3Plus**ï¼š
```csharp
[Ignore]
public LotteryNumber? P1 { get; private set; }
```

**ä¼˜ç‚¹**ï¼š
- âœ… `private set` é˜²æ­¢å¤–éƒ¨ä¿®æ”¹
- âœ… `?` å¯ç©ºç±»å‹æ›´å®‰å…¨
- âœ… åªèƒ½é€šè¿‡ `FillLotteryData` ä¿®æ”¹

---

### 4. é”™è¯¯å¤„ç†

**BaiShengVx3Plus æ–°å¢**ï¼š
```csharp
public string LastError { get; set; }

public BinggoLotteryData FillLotteryData(...)
{
    try
    {
        // è§£æé€»è¾‘
    }
    catch (Exception ex)
    {
        LastError = $"issueId={issueId}, lotteryData={lotteryData}, msg={ex.Message}";
    }
    return this;
}
```

**ä¼˜ç‚¹**ï¼š
- âœ… è®°å½•é”™è¯¯ä¿¡æ¯
- âœ… ä¸æŠ›å‡ºå¼‚å¸¸ï¼Œæ›´ç¨³å®š
- âœ… ä¾¿äºæ—¥å¿—è¿½è¸ª

---

========================================
  ğŸš€ ç°åœ¨çš„ä¼˜åŠ¿
========================================

### 1. æ•°æ®å®Œæ•´æ€§

âœ… æ¯ä¸ªå·ç éƒ½åŒ…å«å®Œæ•´çš„å±æ€§ä¿¡æ¯
âœ… ç®—æ³•åˆ†æå¯ä»¥ç›´æ¥ä½¿ç”¨è¿™äº›å±æ€§
âœ… ä¸éœ€è¦é‡å¤è®¡ç®—å¤§å°ã€å•åŒç­‰

### 2. ä»£ç ç®€æ´

**ä¹‹å‰**ï¼š
```csharp
// éœ€è¦æ‰‹åŠ¨è®¡ç®—å¤§å°
int number = 7;
string size = (number > 40) ? "å¤§" : "å°";
```

**ç°åœ¨**ï¼š
```csharp
// ç›´æ¥ä½¿ç”¨å±æ€§
string size = data.P1?.GetSizeText();
```

### 3. ç®—æ³•å‹å¥½

```csharp
// ç»Ÿè®¡æœ€è¿‘100æœŸP1çš„å¤§å°åˆ†å¸ƒ
var bigCount = recentData.Count(d => d.P1?.Size == SizeType.Big);

// ç»Ÿè®¡é¾™è™èµ°åŠ¿
var dragonCount = recentData.Count(d => d.DragonTiger == DragonTigerType.Dragon);

// ç»Ÿè®¡å°¾å¤§å°çƒ­åº¦
var tailBigCount = recentData.Count(d => d.P1?.TailSize == TailSizeType.TailBig);
```

### 4. æ‰©å±•æ€§å¼º

**å¯ä»¥è½»æ¾æ·»åŠ æ–°çš„åˆ†æç»´åº¦**ï¼š
```csharp
// æ·»åŠ "ç¦ç¦„å¯¿å–œ"å±æ€§
public enum FuLuShouXiType
{
    Fu = 1,   // ç¦ï¼ˆ1-7ï¼‰
    Lu = 2,   // ç¦„ï¼ˆ8-14ï¼‰
    Shou = 3, // å¯¿ï¼ˆ15-21ï¼‰
    Xi = 4    // å–œï¼ˆ22-28ï¼‰
}
```

---

========================================
  ğŸ“‹ åç»­å·¥ä½œ
========================================

### 1. UI æ•°æ®æ˜¾ç¤º

**éœ€è¦æ›´æ–°**ï¼š
- âœ… `UcBinggoDataLast` - æ˜¾ç¤ºä¸ŠæœŸå¼€å¥–
- âœ… å¼€å¥–å†å²è¡¨æ ¼
- âœ… èµ°åŠ¿å›¾

**ä½¿ç”¨æ–°å±æ€§**ï¼š
```csharp
lblP1.Text = $"{data.P1?.Number} [{data.P1?.GetSizeText()}{data.P1?.GetOddEvenText()}]";
lblSum.Text = $"{data.PSum?.Number} [{data.PSum?.GetSizeText()}{data.PSum?.GetOddEvenText()}]";
lblDragonTiger.Text = data.GetDragonTigerText();
```

### 2. ç®—æ³•æ¨¡å—

**å¯ä»¥å¼€å‘**ï¼š
- èµ°åŠ¿åˆ†æ
- çƒ­åº¦ç»Ÿè®¡
- æ¦‚ç‡è®¡ç®—
- æ¨èç®—æ³•

### 3. æµ‹è¯•éªŒè¯

**éªŒè¯æ•°æ®æ­£ç¡®æ€§**ï¼š
```csharp
// æµ‹è¯•å·ç  7
var num7 = new LotteryNumber(BallPosition.P1, 7);
Assert.Equal(SizeType.Small, num7.Size);          // â‰¤40 ä¸ºå°
Assert.Equal(OddEvenType.Odd, num7.OddEven);      // å¥‡æ•°ä¸ºå•
Assert.Equal(TailSizeType.TailBig, num7.TailSize); // å°¾æ•°7ä¸ºå°¾å¤§
```

---

========================================
  ğŸŠ æ€»ç»“
========================================

### æ ¸å¿ƒæ”¹è¿›

1. âœ… **å®Œå…¨é‡‡ç”¨ F5BotV2 çš„è®¾è®¡æ€æƒ³**
   - LotteryNumber å¯¹è±¡åŒ…å«æ‰€æœ‰å±æ€§
   - BinggoLotteryData ä½¿ç”¨ FillLotteryData æ–¹æ³•
   - ä¿ç•™æ‰€æœ‰ç®—æ³•åˆ†æéœ€è¦çš„å±æ€§

2. âœ… **ä¼˜åŒ–å‘½åå’Œç±»å‹**
   - ä½¿ç”¨ç°ä»£ C# å‘½åè§„èŒƒ
   - è‹±æ–‡å‘½åä¾¿äºç†è§£
   - ç±»å‹å®‰å…¨å’Œå¯ç©ºå¤„ç†

3. âœ… **ä¸ºç®—æ³•åˆ†ææ‰“å¥½åŸºç¡€**
   - æ¯ä¸ªå·ç éƒ½æœ‰å®Œæ•´å±æ€§
   - å¯ä»¥ç›´æ¥ç”¨äºç»Ÿè®¡åˆ†æ
   - æ‰©å±•æ€§å¼º

### å…³é”®ä¼˜åŠ¿

- âœ… æ•°æ®å®Œæ•´ï¼šæ¯ä¸ªå·ç åŒ…å«å¤§å°ã€å•åŒã€å°¾å¤§å°ã€åˆå•åŒ
- âœ… ç®—æ³•å‹å¥½ï¼šå¯ä»¥ç›´æ¥ç”¨ LINQ è¿›è¡Œç»Ÿè®¡åˆ†æ
- âœ… æ˜“äºç»´æŠ¤ï¼šå±æ€§è‡ªåŠ¨è®¡ç®—ï¼Œä¸éœ€è¦æ‰‹åŠ¨ç»´æŠ¤
- âœ… æ‰©å±•æ€§å¼ºï¼šå¯ä»¥è½»æ¾æ·»åŠ æ–°çš„åˆ†æç»´åº¦

---

========================================

æ„Ÿè°¢æ‚¨çš„å®è´µå»ºè®®ï¼
F5BotV2 çš„è®¾è®¡ç¡®å®éå¸¸ç²¾å¦™ï¼
ç°åœ¨å·²ç»å®Œå…¨é‡‡ç”¨å¹¶ä¼˜åŒ–äº†ï¼ğŸ‰

========================================

