# 上下分表样式问题诊断

## 问题描述
选中行后背景全黑，Hover 效果也看不出来。

## 可能原因

### 1. 按钮列干扰
`DataGridViewButtonColumn` 有特殊的绘制机制，可能会影响整行的显示。

### 2. CellPainting 事件未正确触发
需要确认 `CellPainting` 事件是否被正确调用。

### 3. 透明色处理问题
`Color.Transparent` 在某些情况下可能被渲染为黑色。

## 当前实现

```csharp
// 设置透明选中样式
dgvRequests.DefaultCellStyle.SelectionBackColor = Color.Transparent;
dgvRequests.DefaultCellStyle.SelectionForeColor = Color.Black;

// CellPainting 事件
private void DgvRequests_CellPainting(object? sender, DataGridViewCellPaintingEventArgs e)
{
    // 跳过按钮列
    if (dgvRequests.Columns[e.ColumnIndex] is DataGridViewButtonColumn)
    {
        return;  // 让按钮列使用默认绘制
    }
    
    // 绘制背景
    Color baseBackColor = request.Status switch { ... };
    e.Graphics.FillRectangle(backBrush, e.CellBounds);
    
    // 绘制选中效果
    if (isSelected)
    {
        e.Graphics.FillRectangle(
            new SolidBrush(Color.FromArgb(50, 80, 160, 255)),
            e.CellBounds);
    }
    
    // 绘制文本
    e.Graphics.DrawString(...);
    e.Handled = true;
}
```

## 解决方案尝试

### 方案 1: 完全接管按钮列绘制 ❌
- 问题：按钮的交互性会丢失

### 方案 2: 设置行样式而非单元格样式 ✅
- 在 `RowPrePaint` 事件中处理整行背景
- 让按钮列正常绘制

### 方案 3: 移除透明色，使用实际颜色 ✅
- 不使用 `Color.Transparent`
- 直接使用浅色背景

