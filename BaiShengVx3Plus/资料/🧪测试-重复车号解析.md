# ğŸ§ª æµ‹è¯•æŠ¥å‘Š - é‡å¤è½¦å·è§£æ

## ğŸ“‹ æµ‹è¯•æ¡ˆä¾‹

### æµ‹è¯• 1ï¼š`123333å¤§10`

**è¾“å…¥**ï¼š`123333å¤§10`

**æœŸæœ›ç»“æœ**ï¼š
```
è§£æé¡¹æ•°: 3 é¡¹
  - 1å¤§10 (1æ³¨) â†’ æ€»é‡‘é¢: 10
  - 2å¤§10 (1æ³¨) â†’ æ€»é‡‘é¢: 10
  - 3å¤§10 (5æ³¨) â†’ æ€»é‡‘é¢: 50  â† 5ä¸ª"3"ç´¯åŠ 
æ€»é‡‘é¢: 70
å›å¤æ ¼å¼: 1å¤§/2å¤§/3å¤§*5
```

**å®é™…ç»“æœï¼ˆç”¨æˆ·åé¦ˆï¼‰**ï¼š
```
å·²è¿›ä»“3
1å¤§/2å¤§/3å¤§|æ‰£:30|ç•™:2214
```

**é—®é¢˜åˆ†æ**ï¼š
- âœ… è§£æé¡¹æ•°æ­£ç¡®ï¼š3 é¡¹
- âœ… å›å¤æ ¼å¼éƒ¨åˆ†æ­£ç¡®ï¼š`1å¤§/2å¤§/3å¤§`
- âŒ é‡‘é¢é”™è¯¯ï¼šæ‰£äº† 30 å…ƒï¼ˆåº”è¯¥æ˜¯ 70 å…ƒï¼‰
- âŒ å›å¤æ ¼å¼ç¼ºå°‘ `*5`ï¼šåº”è¯¥æ˜¾ç¤º `3å¤§*5`

---

## ğŸ” é—®é¢˜å®šä½

### å¯èƒ½çš„åŸå› 

#### 1. ç¨‹åºæœªé‡æ–°ç¼–è¯‘
**ç—‡çŠ¶**ï¼šä»£ç å·²ä¿®æ”¹ï¼Œä½†è¿è¡Œçš„æ˜¯æ—§ç‰ˆæœ¬

**éªŒè¯æ–¹æ³•**ï¼š
- æ£€æŸ¥ `bin\Debug\net8.0-windows\BaiShengVx3Plus.dll` çš„ä¿®æ”¹æ—¶é—´
- æ˜¯å¦æ™šäºä»£ç ä¿®æ”¹æ—¶é—´ï¼Ÿ

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
# å…³é—­æ‰€æœ‰è¿è¡Œä¸­çš„ç¨‹åº
# é‡æ–°ç¼–è¯‘
cd BaiShengVx3Plus
dotnet build --no-incremental
```

---

#### 2. ä»£ç é€»è¾‘é—®é¢˜
**ç—‡çŠ¶**ï¼šä»£ç ä¿®æ”¹äº†ï¼Œä½†é€»è¾‘ä¸æ­£ç¡®

**éªŒè¯æ–¹æ³•**ï¼š
- æ£€æŸ¥ `BinggoHelper.cs` ç¬¬ 263-265 è¡Œ
- ç¡®è®¤æ˜¯å¦å»é™¤äº† `&& item.Amount == amount`

**å½“å‰ä»£ç **ï¼š
```csharp
var existing = result.Items.FirstOrDefault(item => 
    item.CarNumber == carNumber && item.PlayType == playType);
```

**å¦‚æœä»£ç æ˜¯è¿™æ ·ï¼ˆé”™è¯¯ï¼‰**ï¼š
```csharp
var existing = result.Items.FirstOrDefault(item => 
    item.CarNumber == carNumber && item.PlayType == playType && item.Amount == amount);
```

---

#### 3. æ•°æ®åº“ç¼“å­˜é—®é¢˜
**ç—‡çŠ¶**ï¼šè®¢å•å·²ç»åˆ›å»ºï¼Œä½†é‡‘é¢è®¡ç®—é”™è¯¯

**éªŒè¯æ–¹æ³•**ï¼š
- æŸ¥çœ‹æ•°æ®åº“ä¸­çš„è®¢å•è®°å½•
- æ£€æŸ¥ `V2MemberOrder` è¡¨ä¸­çš„ `BetContentStandar` å­—æ®µ

**è§£å†³æ–¹æ¡ˆ**ï¼š
- æ¸…ç©ºæµ‹è¯•è®¢å•
- é‡æ–°æµ‹è¯•

---

## ğŸ§ª å•å…ƒæµ‹è¯•

### æ‰‹åŠ¨æµ‹è¯•æ­¥éª¤

1. **å…³é—­ç¨‹åº**
2. **é‡æ–°ç¼–è¯‘**
   ```bash
   cd d:\gitcode\wx4helper\BaiShengVx3Plus
   dotnet build --no-incremental
   ```
3. **å¯åŠ¨ç¨‹åº**
4. **æ‰“å¼€æ¶ˆæ¯æ¨¡æ‹Ÿå™¨**ï¼ˆå¼€å‘é€‰é¡¹ â†’ å‘é€æ¶ˆæ¯ï¼‰
5. **è¾“å…¥æµ‹è¯•æ¶ˆæ¯**ï¼š`123333å¤§10`
6. **æŸ¥çœ‹å›å¤**

---

### æœŸæœ›ç»“æœ

**æ¶ˆæ¯æ¨¡æ‹Ÿå™¨æ˜¾ç¤º**ï¼š
```
ä¼šå‘˜: 123333å¤§10

ç³»ç»Ÿ: @ä¼šå‘˜
å·²è¿›ä»“3
1å¤§/2å¤§/3å¤§*5|æ‰£:70|ç•™:xxxx
```

**å…³é”®ç‚¹**ï¼š
- âœ… `3å¤§*5` â† å¿…é¡»æœ‰ `*5` è¡¨ç¤º 5 æ³¨
- âœ… `æ‰£:70` â† å¿…é¡»æ˜¯ 70 å…ƒï¼ˆ10+10+50ï¼‰

---

## ğŸ” è°ƒè¯•æ–¹æ³•

### æ·»åŠ æ—¥å¿—è¾“å‡º

åœ¨ `BinggoHelper.cs` çš„ `AddOrIncrementBetItem` æ–¹æ³•ä¸­æ·»åŠ æ—¥å¿—ï¼š

```csharp
private static void AddOrIncrementBetItem(BinggoBetContent result, int carNumber, BinggoPlayType playType, decimal amount)
{
    // ğŸ”¥ å…³é”®ä¿®å¤ï¼šåªåŒ¹é…è½¦å·å’Œç©æ³•ï¼Œä¸åŒ¹é…é‡‘é¢
    var existing = result.Items.FirstOrDefault(item => 
        item.CarNumber == carNumber && item.PlayType == playType);
    
    if (existing != null)
    {
        // ğŸ”¥ å·²å­˜åœ¨ç›¸åŒè½¦å·+ç©æ³•ï¼šç´¯åŠ æ•°é‡
        existing.AddQuantity();
        
        // ğŸ› è°ƒè¯•æ—¥å¿—
        System.Diagnostics.Debug.WriteLine($"ğŸ” ç´¯åŠ æ³¨æ•°: {carNumber}{playType} - æ•°é‡={existing.Quantity}, æ€»é‡‘é¢={existing.TotalAmount}");
    }
    else
    {
        // ğŸ”¥ é¦–æ¬¡å‡ºç°ï¼šæ–°å¢
        result.Items.Add(new BinggoBetItem(carNumber, playType, amount));
        
        // ğŸ› è°ƒè¯•æ—¥å¿—
        System.Diagnostics.Debug.WriteLine($"ğŸ” æ–°å¢ä¸‹æ³¨: {carNumber}{playType} - é‡‘é¢={amount}");
    }
}
```

---

### æŸ¥çœ‹æ—¥å¿—è¾“å‡º

**æœŸæœ›æ—¥å¿—**ï¼ˆè¾“å…¥ `123333å¤§10`ï¼‰ï¼š
```
ğŸ” æ–°å¢ä¸‹æ³¨: 1å¤§ - é‡‘é¢=10
ğŸ” æ–°å¢ä¸‹æ³¨: 2å¤§ - é‡‘é¢=10
ğŸ” æ–°å¢ä¸‹æ³¨: 3å¤§ - é‡‘é¢=10
ğŸ” ç´¯åŠ æ³¨æ•°: 3å¤§ - æ•°é‡=2, æ€»é‡‘é¢=20
ğŸ” ç´¯åŠ æ³¨æ•°: 3å¤§ - æ•°é‡=3, æ€»é‡‘é¢=30
ğŸ” ç´¯åŠ æ³¨æ•°: 3å¤§ - æ•°é‡=4, æ€»é‡‘é¢=40
ğŸ” ç´¯åŠ æ³¨æ•°: 3å¤§ - æ•°é‡=5, æ€»é‡‘é¢=50
```

---

## ğŸ“Š æ•°æ®éªŒè¯

### æ£€æŸ¥ BinggoBetItem

**ä½ç½®**ï¼š`BaiShengVx3Plus/Models/Games/Binggo/BinggoBetItem.cs`

**å…³é”®å±æ€§**ï¼š
```csharp
public int Quantity { get; set; }  // æ³¨æ•°
public decimal Amount { get; set; }  // å•æ³¨é‡‘é¢
public decimal TotalAmount => Amount * Quantity;  // æ€»é‡‘é¢
```

**ToString() æ–¹æ³•**ï¼š
```csharp
public override string ToString()
{
    return $"{CarNumber}{PlayType}{TotalAmount}";  // ğŸ”¥ ä½¿ç”¨ TotalAmountï¼ˆæ€»é‡‘é¢ï¼‰
}
```

**ToReplyString() æ–¹æ³•**ï¼š
```csharp
public string ToReplyString()
{
    var result = $"{CarNumber}{PlayType}";
    if (Quantity > 1)
    {
        result += $"*{Quantity}";  // ğŸ”¥ æ•°é‡ > 1 æ—¶æ˜¾ç¤º *æ•°é‡
    }
    return result;
}
```

---

### æ£€æŸ¥ BinggoBetContent

**ToReplyString() æ–¹æ³•**ï¼š
```csharp
public string ToReplyString()
{
    if (Items == null || Items.Count == 0)
        return string.Empty;
    
    var sb = new StringBuilder();
    foreach (var item in Items)
    {
        if (sb.Length > 0)
            sb.Append("/");
        sb.Append(item.ToReplyString());  // ğŸ”¥ è°ƒç”¨ BinggoBetItem.ToReplyString()
    }
    return sb.ToString();
}
```

---

## ğŸ¯ å¿«é€ŸéªŒè¯

### æµ‹è¯•ä»£ç ç‰‡æ®µ

åœ¨ç¨‹åºä¸­æ·»åŠ ä¸´æ—¶æµ‹è¯•ä»£ç ï¼š

```csharp
// æµ‹è¯•è§£æé€»è¾‘
var betContent = BinggoHelper.ParseBetContent("123333å¤§10", 123);

Console.WriteLine($"é¡¹æ•°: {betContent.Count}");
Console.WriteLine($"æ€»é‡‘é¢: {betContent.TotalAmount}");
Console.WriteLine($"æ ‡å‡†å­—ç¬¦ä¸²: {betContent.ToStandardString()}");
Console.WriteLine($"å›å¤å­—ç¬¦ä¸²: {betContent.ToReplyString()}");

foreach (var item in betContent.Items)
{
    Console.WriteLine($"  {item.CarNumber}{item.PlayType}: å•æ³¨={item.Amount}, æ•°é‡={item.Quantity}, æ€»é‡‘é¢={item.TotalAmount}");
}
```

**æœŸæœ›è¾“å‡º**ï¼š
```
é¡¹æ•°: 3
æ€»é‡‘é¢: 70
æ ‡å‡†å­—ç¬¦ä¸²: 1å¤§10,2å¤§10,3å¤§50
å›å¤å­—ç¬¦ä¸²: 1å¤§/2å¤§/3å¤§*5

  1å¤§: å•æ³¨=10, æ•°é‡=1, æ€»é‡‘é¢=10
  2å¤§: å•æ³¨=10, æ•°é‡=1, æ€»é‡‘é¢=10
  3å¤§: å•æ³¨=10, æ•°é‡=5, æ€»é‡‘é¢=50
```

---

## ğŸ“ æ’æŸ¥æ¸…å•

- [ ] 1. å…³é—­æ‰€æœ‰è¿è¡Œä¸­çš„ç¨‹åº
- [ ] 2. é‡æ–°ç¼–è¯‘é¡¹ç›®
- [ ] 3. æ£€æŸ¥ DLL ä¿®æ”¹æ—¶é—´
- [ ] 4. å¯åŠ¨ç¨‹åº
- [ ] 5. ä½¿ç”¨æ¶ˆæ¯æ¨¡æ‹Ÿå™¨æµ‹è¯•
- [ ] 6. æŸ¥çœ‹æ—¥å¿—è¾“å‡º
- [ ] 7. éªŒè¯é‡‘é¢è®¡ç®—
- [ ] 8. éªŒè¯å›å¤æ ¼å¼

---

## ğŸš¨ ç´§æ€¥ä¿®å¤

å¦‚æœé‡æ–°ç¼–è¯‘åä»ç„¶ä¸è¡Œï¼Œå¯èƒ½éœ€è¦ï¼š

1. **æ¸…ç†è§£å†³æ–¹æ¡ˆ**
   ```bash
   dotnet clean
   dotnet build
   ```

2. **åˆ é™¤ bin å’Œ obj æ–‡ä»¶å¤¹**
   ```bash
   Remove-Item -Recurse -Force bin, obj
   dotnet build
   ```

3. **æ£€æŸ¥æ˜¯å¦æœ‰å¤šä¸ªè¿›ç¨‹**
   - ä»»åŠ¡ç®¡ç†å™¨ â†’ æŸ¥æ‰¾ `BaiShengVx3Plus.exe`
   - ç»“æŸæ‰€æœ‰è¿›ç¨‹

---

**æµ‹è¯•æ—¶é—´**ï¼š2025-11-18 15:13  
**æµ‹è¯•è¾“å…¥**ï¼š`123333å¤§10`  
**å®é™…è¾“å‡º**ï¼š`1å¤§/2å¤§/3å¤§|æ‰£:30|ç•™:2214`  
**æœŸæœ›è¾“å‡º**ï¼š`1å¤§/2å¤§/3å¤§*5|æ‰£:70|ç•™:xxxx`  
**é—®é¢˜çŠ¶æ€**ï¼šâš ï¸ å¾…éªŒè¯ï¼ˆå¯èƒ½æ˜¯æ—§ä»£ç è¿è¡Œï¼‰

