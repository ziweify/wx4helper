# æ°¸åˆ©ç³»ç»Ÿ MVVM æ¡†æ¶æ–¹æ¡ˆè¯´æ˜

**ğŸ“… åˆ›å»ºæ—¥æœŸ**: 2025å¹´12æœˆ19æ—¥  
**ğŸ“Œ ä¸»é¢˜**: MVVM æ¡†æ¶å®ç°æ–¹æ¡ˆå¯¹æ¯”ä¸é€‰æ‹©

---

## ğŸ¯ æˆ‘ä»¬ä½¿ç”¨çš„æ–¹æ¡ˆ

### âœ… è‡ªå®šä¹‰è½»é‡çº§ MVVM æ¡†æ¶

æˆ‘ä»¬**æ²¡æœ‰ä½¿ç”¨** DevExpress çš„ MVVM æ¡†æ¶ï¼Œè€Œæ˜¯åˆ›å»ºäº†ä¸€ä¸ª**è‡ªå®šä¹‰çš„è½»é‡çº§ MVVM å®ç°**ã€‚

**æ ¸å¿ƒç»„ä»¶**ï¼ˆä½äº `Core/` æ–‡ä»¶å¤¹ï¼‰ï¼š
```
æ°¸åˆ©ç³»ç»Ÿ/Core/
â”œâ”€â”€ ObservableObject.cs      # å®ç° INotifyPropertyChanged
â”œâ”€â”€ RelayCommand.cs           # å®ç° ICommand å‘½ä»¤æ¨¡å¼
â”œâ”€â”€ ViewModelBase.cs          # ViewModel åŸºç±»
â””â”€â”€ NavigationService.cs      # é¡µé¢å¯¼èˆªæœåŠ¡
```

---

## ğŸ“Š æ–¹æ¡ˆå¯¹æ¯”

### æ–¹æ¡ˆ1: è‡ªå®šä¹‰ MVVM æ¡†æ¶ï¼ˆæˆ‘ä»¬çš„é€‰æ‹©ï¼‰âœ…

**ä¼˜ç‚¹**ï¼š
- âœ… **è½»é‡çº§** - åªæœ‰ 4 ä¸ªæ ¸å¿ƒç±»ï¼Œçº¦ 200 è¡Œä»£ç 
- âœ… **æ— é¢å¤–ä¾èµ–** - ä¸éœ€è¦å¼•å…¥é¢å¤–çš„ DLL
- âœ… **æ˜“äºç†è§£** - ä»£ç ç®€å•ï¼Œå®¹æ˜“å­¦ä¹ å’Œç»´æŠ¤
- âœ… **çµæ´»å®šåˆ¶** - å¯ä»¥æ ¹æ®éœ€æ±‚éšæ—¶ä¿®æ”¹
- âœ… **å®Œå…¨æ§åˆ¶** - ä¸ä¾èµ–ç¬¬ä¸‰æ–¹æ¡†æ¶æ›´æ–°
- âœ… **é€‚åˆ WinForms** - é’ˆå¯¹ WinForms ä¼˜åŒ–

**ç¼ºç‚¹**ï¼š
- âŒ åŠŸèƒ½ç›¸å¯¹ç®€å•ï¼ˆä½†å¯¹å¤§å¤šæ•°åœºæ™¯å¤Ÿç”¨ï¼‰
- âŒ ç¼ºå°‘ä¸€äº›é«˜çº§ç‰¹æ€§ï¼ˆå¦‚ IoCã€Messenger ç­‰ï¼‰

**é€‚ç”¨åœºæ™¯**ï¼š
- ä¸­å°å‹ WinForms åº”ç”¨
- éœ€è¦ç®€å•æ¸…æ™°çš„ä»£ç ç»“æ„
- å›¢é˜Ÿæˆå‘˜å¯¹ MVVM ä¸å¤ªç†Ÿæ‚‰
- ä¸æƒ³å¼•å…¥è¿‡å¤šä¾èµ–

---

### æ–¹æ¡ˆ2: DevExpress MVVM Frameworkï¼ˆæœªä½¿ç”¨ï¼‰

**è¯´æ˜**ï¼š
DevExpress æä¾›äº†è‡ªå·±çš„ MVVM æ¡†æ¶ï¼Œéœ€è¦å¼•ç”¨ï¼š
```
DevExpress.Mvvm.v23.2.dll
DevExpress.Mvvm.UI.v23.2.dll
```

**ä¼˜ç‚¹**ï¼š
- âœ… åŠŸèƒ½å®Œæ•´ - æä¾› IoCã€Messengerã€Services ç­‰
- âœ… å®˜æ–¹æ”¯æŒ - DevExpress å®˜æ–¹ç»´æŠ¤
- âœ… ä¸ DevExpress æ§ä»¶æ·±åº¦é›†æˆ
- âœ… æ–‡æ¡£å®Œå–„ - å®˜æ–¹æœ‰è¯¦ç»†æ–‡æ¡£å’Œç¤ºä¾‹

**ç¼ºç‚¹**ï¼š
- âŒ **é‡é‡çº§** - éœ€è¦é¢å¤–å¼•ç”¨å¤šä¸ª DLL
- âŒ **å­¦ä¹ æ›²çº¿** - æ¦‚å¿µè¾ƒå¤šï¼Œéœ€è¦æ—¶é—´å­¦ä¹ 
- âŒ **è¿‡åº¦è®¾è®¡** - å¯¹ç®€å•åº”ç”¨æ¥è¯´å¤ªå¤æ‚
- âŒ **ä¾èµ–é”å®š** - ç»‘å®šåˆ° DevExpress ç”Ÿæ€

**é€‚ç”¨åœºæ™¯**ï¼š
- å¤§å‹ä¼ä¸šçº§åº”ç”¨
- éœ€è¦å¤æ‚çš„æ¨¡å—åŒ–æ¶æ„
- å›¢é˜Ÿç†Ÿæ‚‰ DevExpress MVVM
- å·²ç»æ·±åº¦ä½¿ç”¨ DevExpress å…¨å®¶æ¡¶

---

### æ–¹æ¡ˆ3: CommunityToolkit.Mvvm (åŸ Microsoft.Toolkit.Mvvm)

**è¯´æ˜**ï¼š
å¾®è½¯å®˜æ–¹æ¨èçš„ MVVM å·¥å…·åŒ…ï¼Œéœ€è¦å¼•ç”¨ï¼š
```xml
<PackageReference Include="CommunityToolkit.Mvvm" Version="8.2.2" />
```

**ä¼˜ç‚¹**ï¼š
- âœ… å®˜æ–¹æ¨è - å¾®è½¯ç»´æŠ¤
- âœ… ç°ä»£åŒ– - ä½¿ç”¨ Source Generators
- âœ… é«˜æ€§èƒ½ - ç¼–è¯‘æ—¶ç”Ÿæˆä»£ç 
- âœ… è·¨å¹³å° - WPFã€WinFormsã€MAUI éƒ½æ”¯æŒ

**ç¼ºç‚¹**ï¼š
- âŒ éœ€è¦é¢å¤– NuGet åŒ…
- âŒ Source Generators å¯èƒ½å¢åŠ å¤æ‚åº¦
- âŒ å¯¹äºç®€å•åœºæ™¯æœ‰ç‚¹è¿‡åº¦

**é€‚ç”¨åœºæ™¯**ï¼š
- è·¨å¹³å°åº”ç”¨
- éœ€è¦é«˜æ€§èƒ½çš„å¤§å‹åº”ç”¨
- å–œæ¬¢ç”¨æœ€æ–°æŠ€æœ¯

---

## ğŸ” æˆ‘ä»¬çš„è‡ªå®šä¹‰æ¡†æ¶è¯¦è§£

### 1. ObservableObject.cs

**åŠŸèƒ½**ï¼šå®ç°å±æ€§å˜æ›´é€šçŸ¥

```csharp
public abstract class ObservableObject : INotifyPropertyChanged
{
    public event PropertyChangedEventHandler? PropertyChanged;
    
    protected bool SetProperty<T>(ref T field, T value, 
        [CallerMemberName] string? propertyName = null)
    {
        if (EqualityComparer<T>.Default.Equals(field, value))
            return false;
            
        field = value;
        OnPropertyChanged(propertyName);
        return true;
    }
}
```

**ä½¿ç”¨ç¤ºä¾‹**ï¼š
```csharp
private string _name;
public string Name
{
    get => _name;
    set => SetProperty(ref _name, value);  // è‡ªåŠ¨è§¦å‘é€šçŸ¥
}
```

---

### 2. RelayCommand.cs

**åŠŸèƒ½**ï¼šå®ç°å‘½ä»¤æ¨¡å¼

```csharp
public class RelayCommand : ICommand
{
    private readonly Action<object?> _execute;
    private readonly Func<object?, bool>? _canExecute;
    
    public event EventHandler? CanExecuteChanged;
    
    public void Execute(object? parameter) => _execute(parameter);
    public bool CanExecute(object? parameter) => 
        _canExecute?.Invoke(parameter) ?? true;
}
```

**ä½¿ç”¨ç¤ºä¾‹**ï¼š
```csharp
public ICommand SaveCommand { get; private set; }

SaveCommand = new RelayCommand(
    execute: _ => SaveData(),
    canExecute: _ => !IsBusy && HasChanges
);
```

---

### 3. ViewModelBase.cs

**åŠŸèƒ½**ï¼šViewModel é€šç”¨åŸºç±»

```csharp
public abstract class ViewModelBase : ObservableObject
{
    public bool IsBusy { get; set; }
    public string Title { get; set; }
    
    public virtual void OnLoaded() { }
    public virtual void OnUnloaded() { }
}
```

**ä½¿ç”¨ç¤ºä¾‹**ï¼š
```csharp
public class MainViewModel : ViewModelBase
{
    public MainViewModel()
    {
        Title = "ä¸»çª—å£";
    }
    
    public override void OnLoaded()
    {
        // é¡µé¢åŠ è½½æ—¶æ‰§è¡Œ
    }
}
```

---

### 4. NavigationService.cs

**åŠŸèƒ½**ï¼šé¡µé¢å¯¼èˆªç®¡ç†

```csharp
public class NavigationService
{
    private readonly Panel _contentPanel;
    private readonly Dictionary<string, UserControl> _pages;
    
    public void RegisterPage(string key, UserControl page) { }
    public void NavigateTo(string pageKey) { }
}
```

**ä½¿ç”¨ç¤ºä¾‹**ï¼š
```csharp
// æ³¨å†Œé¡µé¢
_navigationService.RegisterPage("Dashboard", new DashboardPage());

// å¯¼èˆª
_navigationService.NavigateTo("Dashboard");
```

---

## ğŸ“ˆ ä¸ºä»€ä¹ˆé€‰æ‹©è‡ªå®šä¹‰æ–¹æ¡ˆï¼Ÿ

### 1. **ç®€å•æ€§**
å¯¹äºæ°¸åˆ©ç³»ç»Ÿè¿™æ ·çš„æ•°æ®ç®¡ç†å¹³å°ï¼Œè‡ªå®šä¹‰æ¡†æ¶å·²ç»è¶³å¤Ÿï¼š
- âœ… æ•°æ®ç»‘å®š - `INotifyPropertyChanged`
- âœ… å‘½ä»¤æ¨¡å¼ - `ICommand`
- âœ… é¡µé¢å¯¼èˆª - `NavigationService`
- âœ… ç”Ÿå‘½å‘¨æœŸ - `OnLoaded/OnUnloaded`

### 2. **å­¦ä¹ æˆæœ¬ä½**
- åªéœ€ç†è§£ 4 ä¸ªæ ¸å¿ƒç±»
- ä»£ç ç®€å•æ˜“æ‡‚
- å®¹æ˜“åŸ¹è®­æ–°å›¢é˜Ÿæˆå‘˜

### 3. **æ— é¢å¤–ä¾èµ–**
- ä¸å¢åŠ é¡¹ç›®ä½“ç§¯
- ä¸æ‹…å¿ƒä¾èµ–å†²çª
- ä¸ä¾èµ–å¤–éƒ¨æ›´æ–°

### 4. **æ˜“äºå®šåˆ¶**
- éœ€è¦æ–°åŠŸèƒ½ï¼Ÿç›´æ¥ä¿®æ”¹æºç 
- ä¸å—ç¬¬ä¸‰æ–¹æ¡†æ¶é™åˆ¶
- å®Œå…¨æŒæ§

---

## ğŸ”„ å¦‚æœéœ€è¦æ›´å¼ºå¤§çš„åŠŸèƒ½

### å¯ä»¥è½»æ¾è¿ç§»åˆ°å…¶ä»–æ¡†æ¶

æˆ‘ä»¬çš„è‡ªå®šä¹‰æ¡†æ¶ä½¿ç”¨äº†**æ ‡å‡†æ¥å£**ï¼š
- `INotifyPropertyChanged` - æ ‡å‡†å±æ€§é€šçŸ¥æ¥å£
- `ICommand` - æ ‡å‡†å‘½ä»¤æ¥å£

è¿™æ„å‘³ç€ï¼š
- âœ… ViewModels å¯ä»¥æ— ç¼è¿ç§»åˆ°å…¶ä»–æ¡†æ¶
- âœ… å¯ä»¥é€æ­¥å¼•å…¥ CommunityToolkit.Mvvm
- âœ… å¯ä»¥åˆ‡æ¢åˆ° DevExpress MVVM

**è¿ç§»ç¤ºä¾‹**ï¼ˆå¦‚æœå°†æ¥éœ€è¦ï¼‰ï¼š

```xml
<!-- æ·»åŠ  CommunityToolkit.Mvvm -->
<PackageReference Include="CommunityToolkit.Mvvm" Version="8.2.2" />
```

```csharp
// å°†æ¥åªéœ€æ”¹åŸºç±»ï¼Œä»£ç é€»è¾‘ä¸å˜
// ä»ï¼š
public class MainViewModel : ViewModelBase

// æ”¹ä¸ºï¼š
public class MainViewModel : ObservableObject  // CommunityToolkit çš„
```

---

## ğŸ“Š åŠŸèƒ½å¯¹æ¯”è¡¨

| åŠŸèƒ½ | è‡ªå®šä¹‰æ¡†æ¶ | DevExpress MVVM | CommunityToolkit |
|-----|-----------|-----------------|------------------|
| å±æ€§é€šçŸ¥ | âœ… | âœ… | âœ… |
| å‘½ä»¤æ¨¡å¼ | âœ… | âœ… | âœ… |
| ä¾èµ–æ³¨å…¥ | âŒ | âœ… | âœ… |
| æ¶ˆæ¯ä¼ é€’ | âŒ | âœ… | âœ… |
| å¯¼èˆªæœåŠ¡ | âœ… (ç®€å•) | âœ… (å®Œæ•´) | âœ… (å®Œæ•´) |
| éªŒè¯ | âŒ | âœ… | âœ… |
| Source Gen | âŒ | âŒ | âœ… |
| ä»£ç è¡Œæ•° | ~200 | ~5000+ | ~1000+ |
| DLL å¤§å° | 0 (å†…ç½®) | ~2MB | ~50KB |

---

## ğŸ’¡ æœ€ä½³å®è·µå»ºè®®

### å½“å‰é¡¹ç›®ï¼ˆæ°¸åˆ©ç³»ç»Ÿï¼‰
- âœ… **ç»§ç»­ä½¿ç”¨è‡ªå®šä¹‰æ¡†æ¶** - å·²ç»å¤Ÿç”¨
- âœ… ä»£ç ç®€å•æ¸…æ™°ï¼Œæ˜“äºç»´æŠ¤
- âœ… æ»¡è¶³æ‰€æœ‰ä¸šåŠ¡éœ€æ±‚

### ä½•æ—¶è€ƒè™‘å‡çº§æ¡†æ¶ï¼Ÿ

å½“å‡ºç°ä»¥ä¸‹éœ€æ±‚æ—¶ï¼š
1. éœ€è¦å¤æ‚çš„æ¨¡å—é—´é€šä¿¡ï¼ˆMessengerï¼‰
2. éœ€è¦ä¾èµ–æ³¨å…¥ï¼ˆIoC Containerï¼‰
3. éœ€è¦æ•°æ®éªŒè¯æ¡†æ¶
4. å›¢é˜Ÿå·²ç»ç†Ÿæ‚‰æŸä¸ªæ¡†æ¶
5. éœ€è¦ä¸å…¶ä»–æŠ€æœ¯æ ˆï¼ˆWPF/MAUIï¼‰å…±äº«ä»£ç 

---

## ğŸ“ å­¦ä¹ èµ„æº

### è‡ªå®šä¹‰ MVVM æ¨¡å¼
- å¾®è½¯å®˜æ–¹æ–‡æ¡£: https://learn.microsoft.com/en-us/dotnet/architecture/maui/mvvm
- MVVM æ¨¡å¼è®²è§£: https://www.tutorialspoint.com/mvvm/

### DevExpress MVVMï¼ˆå¦‚æœå°†æ¥éœ€è¦ï¼‰
- å®˜æ–¹æ–‡æ¡£: https://docs.devexpress.com/WPF/15112/mvvm-framework
- ç¤ºä¾‹ä»£ç : https://github.com/DevExpress/DevExtreme.AspNet.Data

### CommunityToolkit.Mvvm
- GitHub: https://github.com/CommunityToolkit/dotnet
- æ–‡æ¡£: https://learn.microsoft.com/en-us/dotnet/communitytoolkit/mvvm/

---

## âœ… æ€»ç»“

### æˆ‘ä»¬çš„é€‰æ‹©ï¼šè‡ªå®šä¹‰è½»é‡çº§ MVVM æ¡†æ¶

**åŸå› **ï¼š
1. âœ… ç®€å•æ˜“æ‡‚ - åªæœ‰ 4 ä¸ªæ ¸å¿ƒç±»
2. âœ… æ— é¢å¤–ä¾èµ– - ä¸å¢åŠ é¡¹ç›®å¤æ‚åº¦
3. âœ… åŠŸèƒ½å¤Ÿç”¨ - æ»¡è¶³æ•°æ®ç®¡ç†å¹³å°çš„æ‰€æœ‰éœ€æ±‚
4. âœ… æ˜“äºå®šåˆ¶ - å®Œå…¨æŒæ§ä»£ç 
5. âœ… å¯æ‰©å±•æ€§ - ä½¿ç”¨æ ‡å‡†æ¥å£ï¼Œå°†æ¥å¯è¿ç§»

**ä¸ä½¿ç”¨ DevExpress MVVM çš„åŸå› **ï¼š
1. âŒ å¯¹äºæˆ‘ä»¬çš„éœ€æ±‚æ¥è¯´å¤ªé‡äº†
2. âŒ å­¦ä¹ æˆæœ¬é«˜
3. âŒ å¢åŠ ä¸å¿…è¦çš„ä¾èµ–
4. âŒ æˆ‘ä»¬éœ€è¦çš„åŠŸèƒ½å·²ç»å®ç°äº†

**ç»“è®º**ï¼š
è‡ªå®šä¹‰æ¡†æ¶æ˜¯**æœ€é€‚åˆæ°¸åˆ©ç³»ç»Ÿ**çš„é€‰æ‹©ï¼Œæ—¢ç®€å•åˆå¼ºå¤§ï¼Œå®Œç¾å¹³è¡¡äº†åŠŸèƒ½å’Œå¤æ‚åº¦ã€‚

---

**è¯´æ˜æ–‡ä»¶ç¼–å·**: 251219-007  
**åˆ›å»ºæ—¶é—´**: 2025-12-19  
**æ–‡ä»¶ç±»å‹**: æŠ€æœ¯æ–¹æ¡ˆè¯´æ˜  
**ç‰ˆæœ¬**: v1.0

