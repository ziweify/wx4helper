# 上下分管理窗口设计文档

## 📅 创建日期
2025-12-26

## 🎯 设计目标
为永利系统的微信助手创建一个现代化、美观的上下分管理窗口，参考 BaiShengVx3Plus 的设计，但使用更现代的 UI 风格。

---

## 🎨 设计特点

### 1. 无边框设计
- **FormBorderStyle**: `None`
- **自定义标题栏**: 蓝色渐变背景 (`RGB(32, 128, 255)`)
- **可拖动**: 通过 Win32 API 实现标题栏拖动
- **最小化/关闭按钮**: 自绘按钮，带 Hover 效果

### 2. 配色方案
| 区域 | 颜色 | RGB | 用途 |
|------|------|-----|------|
| 标题栏 | 蓝色 | `RGB(32, 128, 255)` | 主色调 |
| 背景 | 浅灰 | `RGB(250, 250, 250)` | 柔和的背景 |
| 状态栏 | 中灰 | `RGB(240, 240, 240)` | 区分底部 |
| 待处理 | 红色 | `RGB(255, 77, 79)` | 警示色 |
| 上分 | 绿色 | `RGB(67, 207, 124)` | 收入色 |
| 下分 | 橙色 | `RGB(255, 152, 0)` | 支出色 |
| 总余额 | 蓝色 | `RGB(32, 128, 255)` | 信息色 |

### 3. Emoji 图标
使用 Unicode Emoji 增强视觉效果：
- 💰 标题 "上下分管理"
- ⏳ 待处理
- ⬆️ 今日上分
- ⬇️ 今日下分
- 💰 总余额
- 🔄 刷新按钮
- 📁 导出按钮

### 4. 布局结构
```
┌─────────────────────────────────────────────┐
│ 💰 上下分管理          [─] [✕]             │ ← 标题栏 (50px, 蓝色, 可拖动)
├─────────────────────────────────────────────┤
│ 状态: [下拉框] [🔄 刷新] [📁 导出]          │ ← 工具栏 (60px)
├─────────────────────────────────────────────┤
│                                             │
│          GridControl (数据表格)             │ ← 主区域 (自适应)
│                                             │
│                                             │
├─────────────────────────────────────────────┤
│ ⏳ 待处理: 0 笔 | ⬆️ 今日上分: 0.00 | ...   │ ← 状态栏 (50px)
└─────────────────────────────────────────────┘
```

---

## 📋 主要控件

### 控件列表
| 控件名称 | 类型 | 说明 |
|---------|------|------|
| `panelControl_TitleBar` | `PanelControl` | 自定义标题栏 |
| `labelControl_Title` | `LabelControl` | 标题文本 "💰 上下分管理" |
| `simpleButton_Minimize` | `SimpleButton` | 最小化按钮 "─" |
| `simpleButton_Close` | `SimpleButton` | 关闭按钮 "✕" |
| `panelControl_Toolbar` | `PanelControl` | 工具栏面板 |
| `comboBoxEdit_StatusFilter` | `ComboBoxEdit` | 状态筛选下拉框 |
| `simpleButton_Refresh` | `SimpleButton` | 刷新按钮 |
| `simpleButton_Export` | `SimpleButton` | 导出按钮 |
| `gridControl_Requests` | `GridControl` | 数据表格控件 |
| `gridView_Requests` | `GridView` | 表格视图 |
| `panelControl_StatusBar` | `PanelControl` | 底部状态栏 |
| `labelControl_PendingCount` | `LabelControl` | 待处理数量 |
| `labelControl_TodayCredit` | `LabelControl` | 今日上分 |
| `labelControl_TodayWithdraw` | `LabelControl` | 今日下分 |
| `labelControl_TotalBalance` | `LabelControl` | 总余额 |

### 表格列设计（待实现）
| 列名 | 宽度 | 说明 |
|------|------|------|
| 操作按钮 | 120px | 同意/拒绝/忽略 |
| ID | 60px | 申请ID |
| 申请时间 | 140px | yyyy-MM-dd HH:mm:ss |
| 昵称 | 100px | 会员昵称 |
| 动作 | 80px | 上分/下分（带颜色） |
| 金额 | 100px | 金额，右对齐 |
| 状态 | 80px | 等待处理/已同意/已拒绝/已忽略 |
| 处理人 | 90px | 管理员名称 |
| 处理时间 | 140px | yyyy-MM-dd HH:mm:ss |
| 备注 | Fill | 备注信息，自动填充 |

---

## 🎯 功能设计（框架）

### 1. 窗口管理
- ✅ 无边框设计
- ✅ 自定义标题栏
- ✅ 拖动功能
- ✅ 最小化/关闭按钮
- ✅ 居中显示

### 2. 数据筛选
- ✅ 状态下拉框（全部/等待处理/已同意/已拒绝/已忽略）
- ⏳ 筛选逻辑（待实现）

### 3. 数据展示
- ✅ GridControl 表格
- ⏳ 列配置（待实现）
- ⏳ 数据绑定（待实现）
- ⏳ 颜色标记（待实现）

### 4. 操作功能
- ⏳ 同意上下分（待实现）
- ⏳ 拒绝上下分（待实现）
- ⏳ 忽略申请（待实现）

### 5. 统计功能
- ✅ 待处理数量统计
- ✅ 今日上分统计
- ✅ 今日下分统计
- ✅ 总余额统计
- ⏳ 实时更新（待实现）

### 6. 导出功能
- ✅ 导出按钮（占位）
- ⏳ 导出为 Excel（待实现）

---

## 🔗 集成方式

### 在 WechatPage 中调用
```csharp
// 1. 声明窗口引用
private CreditManageForm? _creditManageForm;

// 2. 工具栏按钮点击事件
private void ToolStripButton_CreditWithdrawManage_Click(object sender, EventArgs e)
{
    // 检查窗口是否已打开
    if (_creditManageForm != null && !_creditManageForm.IsDisposed)
    {
        // 激活已存在的窗口
        _creditManageForm.Activate();
        return;
    }
    
    // 创建并显示新窗口
    _creditManageForm = new CreditManageForm();
    _creditManageForm.FormClosed += (s, args) => _creditManageForm = null;
    _creditManageForm.Show();
}
```

### 窗口位置
- **StartPosition**: `CenterScreen`
- **Size**: `1200 x 700`
- **MinimumSize**: `1000 x 600`

---

## 📚 参考项目
**BaiShengVx3Plus/Views/CreditWithdrawManageForm**
- 使用 Sunny.UI 控件
- UIDataGridView 数据表格
- 状态筛选功能
- 操作按钮列（同意/拒绝/忽略）
- 实时统计显示

---

## ✅ 当前进度
- [x] 创建 CreditManageForm.cs（框架）
- [x] 创建 CreditManageForm.Designer.cs（UI设计）
- [x] 在 WechatPage 添加调用
- [x] 编写设计文档
- [ ] 实现 GridView 列配置
- [ ] 实现数据绑定逻辑
- [ ] 实现操作按钮功能
- [ ] 实现统计功能
- [ ] 实现导出功能

---

## 🎨 视觉效果预览

### 标题栏
```
┌──────────────────────────────────────────────┐
│ 💰 上下分管理                   [─] [✕]      │ ← 蓝色背景，白色文字
└──────────────────────────────────────────────┘
```

### 状态栏
```
┌──────────────────────────────────────────────┐
│ ⏳ 待处理: 0 笔 | ⬆️ 今日上分: 0.00 | ...     │ ← 浅灰背景，彩色文字
└──────────────────────────────────────────────┘
```

### 表格（示例）
```
┌───┬──────────┬─────┬────┬─────┬──────┬────┐
│操作│申请时间  │昵称 │动作│金额 │状态  │... │
├───┼──────────┼─────┼────┼─────┼──────┼────┤
│✓✗🚫│2025-12-26│张三 │上分│1000 │等待  │... │
└───┴──────────┴─────┴────┴─────┴──────┴────┘
```

---

## 💡 技术亮点
1. **无边框窗口**: 使用 Win32 API 实现拖动
2. **DevExpress 控件**: 现代化的 UI 组件
3. **Emoji 图标**: 增强视觉效果，无需图片资源
4. **渐变配色**: 专业的配色方案
5. **响应式布局**: 使用 Dock 和 Anchor 实现自适应

---

## 📝 后续优化建议
1. 添加加载动画
2. 添加数据刷新动画
3. 添加操作确认对话框
4. 添加快捷键支持
5. 添加历史记录查询
6. 添加数据导出过滤
7. 添加打印功能
8. 添加数据统计图表

---

**文档版本**: 1.0  
**最后更新**: 2025-12-26

