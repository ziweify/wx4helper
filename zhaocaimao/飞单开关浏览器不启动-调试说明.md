# é£å•å¼€å…³æµè§ˆå™¨ä¸å¯åŠ¨ - è°ƒè¯•è¯´æ˜

## é—®é¢˜æè¿°
æ‰“å¼€ç•Œé¢çš„é£å•å¼€å…³åï¼Œæµè§ˆå™¨æ²¡æœ‰å¯åŠ¨ã€‚

## å·²æ·»åŠ è°ƒè¯•æ—¥å¿—
åœ¨ `BetConfig.IsEnabled` setter ä¸­æ·»åŠ äº†è°ƒè¯•è¾“å‡ºï¼š
1. `Debug.WriteLine`ï¼šè¾“å‡ºåˆ° Visual Studio çš„è¾“å‡ºçª—å£
2. `_logService?.Info`ï¼šè¾“å‡ºåˆ°æ—¥å¿—æ–‡ä»¶

## è°ƒè¯•æ­¥éª¤

### 1. å…³é—­æ­£åœ¨è¿è¡Œçš„ç¨‹åº
ç¨‹åºæ­£åœ¨è¿è¡Œå¯¼è‡´ç¼–è¯‘å¤±è´¥ï¼Œè¯·å…ˆå…³é—­ã€‚

### 2. é‡æ–°ç¼–è¯‘
```powershell
cd d:\gitcode\wx4helper\zhaocaimao
dotnet build
```

### 3. è¿è¡Œç¨‹åºå¹¶æ‰“å¼€é£å•å¼€å…³
- å¯åŠ¨ç¨‹åº
- æ‰“å¼€é£å•å¼€å…³
- æŸ¥çœ‹è°ƒè¯•è¾“å‡º

### 4. æŸ¥çœ‹è°ƒè¯•è¾“å‡º
**æ–¹å¼1ï¼šVisual Studio è¾“å‡ºçª—å£**
- æŸ¥çœ‹è¾“å‡ºçª—å£çš„"è°ƒè¯•"ç±»åˆ«
- æŸ¥æ‰¾ä»¥ä¸‹ä¿¡æ¯ï¼š
  - `ğŸš€ [é…ç½®å] IsEnabled setter è¢«è§¦å‘ï¼Œvalue=true`
  - `ğŸš€ [é…ç½®å] å¼€å§‹è°ƒç”¨ StartBrowserManuallyAsync()`
  - `âœ… [é…ç½®å] StartBrowserManuallyAsync() å®Œæˆ`

**æ–¹å¼2ï¼šæ—¥å¿—æ–‡ä»¶**ï¼ˆå¦‚æœæœ‰ MyLog ç›®å½•ï¼‰
- æŸ¥æ‰¾åŒ…å« `IsEnabled=true` çš„æ—¥å¿—
- æŸ¥æ‰¾åŒ…å« `æµè§ˆå™¨ä¸å­˜åœ¨æˆ–æœªåˆå§‹åŒ–ï¼Œç«‹å³å¯åŠ¨` çš„æ—¥å¿—

## å¯èƒ½çš„é—®é¢˜åŸå› 

### 1. IsEnabled å·²ç»æ˜¯ true
å¦‚æœ `_isEnabled` å·²ç»æ˜¯ trueï¼Œsetter ä¸­çš„æ¡ä»¶ `if (_isEnabled != value)` ä¸æ»¡è¶³ï¼Œä¸ä¼šæ‰§è¡Œå¯åŠ¨é€»è¾‘ã€‚

**è§£å†³æ–¹æ¡ˆ**ï¼š
- åœ¨ `swiAutoOrdersBet_ValueChanged` ä¸­æ·»åŠ å¼ºåˆ¶å¯åŠ¨é€»è¾‘
- æˆ–è€…å…ˆè®¾ç½®ä¸º falseï¼Œå†è®¾ç½®ä¸º true

### 2. _logService ä¸º null
å¦‚æœ `SetDependencies` æ²¡æœ‰è¢«è°ƒç”¨ï¼Œ`_logService` ä¸º nullï¼Œå¯¼è‡´æ²¡æœ‰æ—¥å¿—è¾“å‡ºã€‚

**è§£å†³æ–¹æ¡ˆ**ï¼š
- æ£€æŸ¥ `AutoBetService.SetDatabase` æ˜¯å¦è¢«è°ƒç”¨
- æ£€æŸ¥ `InjectDependenciesToConfigs` æ˜¯å¦æ‰§è¡Œ

### 3. StartBrowserManuallyAsync å¼‚å¸¸
å¦‚æœå¯åŠ¨è¿‡ç¨‹ä¸­æŠ›å‡ºå¼‚å¸¸ï¼Œä¼šè¢« catch æ•è·å¹¶è®°å½•ã€‚

**è§£å†³æ–¹æ¡ˆ**ï¼š
- æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶ä¸­çš„å¼‚å¸¸ä¿¡æ¯
- æŸ¥çœ‹ Debug è¾“å‡ºä¸­çš„å¼‚å¸¸ä¿¡æ¯

## å¿«é€Ÿä¿®å¤
å¦‚æœé—®é¢˜æ˜¯ `IsEnabled` å·²ç»æ˜¯ trueï¼Œå¯ä»¥åœ¨é£å•å¼€å…³äº‹ä»¶å¤„ç†ä¸­æ·»åŠ å¼ºåˆ¶å¯åŠ¨é€»è¾‘ï¼š

```csharp
// åœ¨ swiAutoOrdersBet_ValueChanged ä¸­
if (value) // å¼€å¯è‡ªåŠ¨æŠ•æ³¨
{
    var defaultConfig = _autoBetService.GetConfigs().FirstOrDefault(c => c.IsDefault);
    if (defaultConfig != null)
    {
        // ğŸ”¥ å¼ºåˆ¶å¯åŠ¨æµè§ˆå™¨ï¼ˆä¸ç®¡ IsEnabled æ˜¯å¦å·²ç»æ˜¯ trueï¼‰
        if (!defaultConfig.IsConnected)
        {
            _ = Task.Run(async () =>
            {
                try
                {
                    await defaultConfig.StartBrowserManuallyAsync();
                }
                catch (Exception ex)
                {
                    _logService.Error("VxMain", "å¯åŠ¨æµè§ˆå™¨å¤±è´¥", ex);
                }
            });
        }
        
        // ç„¶åè®¾ç½® IsEnabled = true
        defaultConfig.IsEnabled = true;
        _autoBetService.SaveConfig(defaultConfig);
    }
}
```

## ä¸‹ä¸€æ­¥
è¯·æŒ‰ç…§ä»¥ä¸Šæ­¥éª¤è°ƒè¯•ï¼ŒæŸ¥çœ‹è°ƒè¯•è¾“å‡ºï¼Œç¡®å®šé—®é¢˜åŸå› ã€‚

